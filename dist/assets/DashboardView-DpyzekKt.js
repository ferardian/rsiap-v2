import{r as v,c as x,w as ue,o as le,a as u,i as r,b as e,e as C,D as m,A as S,B as G,F as z,f as X,n as P,t as i,G as se,H as ve,z as B,E as me,I as Z,J as ce,l as pe,m as re,g as fe}from"./vendor-abe1rO6K.js";import{_ as ne,a as ge,b as be,c as ke,p as ye,u as $e}from"./index-CXPIpl-L.js";import{s as R}from"./notification-DtWby6W5.js";import{u as _e}from"./role-tX4kyy7r.js";import"./api-B9ygI19o.js";const he={class:"menu-management-modal-overlay"},we={class:"menu-management-modal"},Me={class:"modal-header"},Ce={class:"modal-body"},xe={class:"filter-section-modern"},Ue={class:"filter-content"},Re={class:"filter-grid"},Se={class:"filter-item"},Ae={class:"search-input-wrapper"},Pe={class:"filter-item"},Te={class:"status-filter"},De=["onClick"],Ve={class:"filter-item"},Ie={class:"parent-select-wrapper"},Fe=["value"],Le={class:"filter-item"},Ee={class:"action-buttons"},Ne={class:"table-section"},je={class:"table-responsive"},Be={class:"table table-hover"},qe={key:0},He={class:"menu-name-cell"},Ge={class:"menu-icon"},Ke={class:"menu-name"},Oe={key:0,class:"text-muted d-block"},Je={class:"text-primary"},Qe={class:"btn-group btn-group-sm"},We=["onClick"],ze=["onClick"],Xe={key:0,class:"pagination-container"},Ye={class:"pagination-info"},Ze={class:"info-text"},es={key:0},ss={key:0},ts={class:"pagination"},as=["onClick"],ls={key:0,class:"modal fade show",style:{display:"block"},tabindex:"-1"},ns={class:"modal-dialog modal-lg"},os={class:"modal-content"},is={class:"modal-header"},rs={class:"modal-title"},us={class:"modal-body-modern"},ds={class:"form-grid"},cs={class:"form-group-modern"},vs={class:"input-wrapper-modern"},ms={key:0,class:"error-message-modern"},ps={class:"form-group-modern"},fs={class:"input-wrapper-modern"},gs={key:0,class:"error-message-modern"},bs={class:"form-group-modern"},ks={class:"input-wrapper-modern"},ys={class:"form-group-modern"},$s={class:"input-wrapper-modern"},_s={class:"form-group-modern"},hs={class:"select-wrapper-modern"},ws=["value"],Ms={class:"form-group-modern"},Cs={class:"toggle-wrapper-modern"},xs={class:"toggle-switch"},Us={class:"toggle-label"},Rs={class:"toggle-text"},Ss={class:"toggle-icon"},As={class:"modal-footer-modern"},Ps=["disabled"],Ts={class:"btn-content"},Ds={key:0,class:"btn-icon"},Vs={key:1,class:"btn-spinner"},Is={class:"btn-text"},Fs={class:"delete-modal"},Ls={class:"delete-modal-header"},Es={class:"delete-modal-body"},Ns={class:"delete-message"},js={key:0,class:"delete-warning"},Bs={class:"delete-modal-footer"},qs=["disabled"],Hs={key:0,class:"spinner-border spinner-border-sm me-2"},Gs={key:1,class:"fas fa-trash me-2"},Ks={__name:"MenuManagementModal",emits:["close"],setup(oe){const E=ge(),g=v(""),N=v(""),T=v(""),b=v(1),I=v(10),$=v("urutan"),A=v("asc"),D=v(!1),V=v(!1),w=v(!1),j=v(null),f=v({id_menu:null,nama_menu:"",icon:"",route:"",parent_id:null,urutan:1,is_active:!0}),h=v({}),d=v(null),H=v([{value:"",label:"Semua",icon:"fas fa-list"},{value:!0,label:"Aktif",icon:"fas fa-check-circle"},{value:!1,label:"Non-aktif",icon:"fas fa-times-circle"}]),L=x(()=>{let t=[...E.flatMenuList];if(console.log("Computing filteredMenus. Original menus length:",t.length),console.log("Original menus:",t),g.value){const s=g.value.toLowerCase();t=t.filter(y=>{var M;return y.nama_menu.toLowerCase().includes(s)||((M=y.route)==null?void 0:M.toLowerCase().includes(s))})}return N.value!==""&&(t=t.filter(s=>s.is_active===N.value)),T.value!==""&&T.value!==null?t=t.filter(s=>s.parent_id===T.value):T.value===null&&(t=t.filter(s=>s.parent_id===null)),t.sort((s,y)=>{let M=s[$.value],n=y[$.value];return A.value==="asc"?M>n?1:-1:M<n?1:-1}),console.log("Final filtered menus length:",t.length),console.log("Final filtered menus:",t),console.log("Filter values:",{searchQuery:g.value,filterActive:N.value,filterParent:T.value}),t}),F=x(()=>Math.ceil(L.value.length/I.value)),K=x(()=>(b.value-1)*I.value),_=x(()=>K.value+I.value),a=x(()=>L.value.slice(K.value,_.value)),p=x(()=>{const t=[];let y=Math.max(1,b.value-Math.floor(2.5)),M=Math.min(F.value,y+5-1);M-y+1<5&&(y=Math.max(1,M-5+1));for(let n=y;n<=M;n++)t.push(n);return t}),q=x(()=>E.flatMenuList.filter(t=>t.parent_id===null)),O=x(()=>w.value?E.flatMenuList.filter(t=>t.id_menu!==f.value.id_menu):q.value),J=async()=>{try{j.value=null,console.log("Fetching menus...");const t=await E.fetchAllMenus();console.log("Fetch result:",t),console.log("Menu store data:",E.menus),console.log("Menu store flatMenuList:",E.flatMenuList)}catch(t){j.value="Gagal memuat data menu",console.error("Error fetching menus:",t)}},Q=()=>{clearTimeout(Q.timer),Q.timer=setTimeout(()=>{b.value=1},300)},ee=t=>{$.value===t?A.value=A.value==="asc"?"desc":"asc":($.value=t,A.value="asc")},k=()=>{g.value="",N.value="",T.value="",b.value=1},l=t=>{w.value=!0,f.value={...t},D.value=!0,h.value={}},U=()=>{D.value=!1,w.value=!1,f.value={id_menu:null,nama_menu:"",icon:"",route:"",parent_id:null,urutan:1,is_active:!0},h.value={}},c=()=>(h.value={},f.value.nama_menu.trim()||(h.value.nama_menu="Nama menu wajib diisi"),(!f.value.urutan||f.value.urutan<1)&&(h.value.urutan="Urutan harus diisi dengan angka minimal 1"),Object.keys(h.value).length===0),W=async()=>{if(c())try{const t={...f.value};delete t.id_menu,delete t.children,delete t.parent;let s;w.value?s=await E.updateMenu(f.value.id_menu,t):s=await E.createMenu(t),s.success?(R(w.value?"Menu berhasil diperbarui":"Menu berhasil ditambahkan","success"),U(),await J()):R(s.error||"Gagal menyimpan menu","error")}catch(t){R("Terjadi kesalahan saat menyimpan menu","error"),console.error("Error saving menu:",t)}},te=t=>{d.value=t,V.value=!0},o=async()=>{if(d.value)try{const t=await E.deleteMenu(d.value.id_menu);t.success?(R("Menu berhasil dihapus","success"),V.value=!1,d.value=null,await J()):R(t.error||"Gagal menghapus menu","error")}catch(t){R("Terjadi kesalahan saat menghapus menu","error"),console.error("Error deleting menu:",t)}};return ue([N,T],()=>{b.value=1}),le(()=>{J()}),(t,s)=>{var y,M;return r(),u("div",he,[e("div",we,[e("div",Me,[s[21]||(s[21]=e("h4",null,"ðŸ“‹ Kelola Menu",-1)),e("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=n=>t.$emit("close"))}," Ã— ")]),e("div",Ce,[e("div",xe,[s[32]||(s[32]=e("div",{class:"filter-header"},[e("h5",{class:"filter-title"},[e("i",{class:"fas fa-filter"}),m(" Filter & Pencarian ")])],-1)),e("div",Ue,[e("div",Re,[e("div",Se,[s[24]||(s[24]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-search"}),e("span",null,"Cari Menu")],-1)),e("div",Ae,[s[23]||(s[23]=e("div",{class:"search-icon"},[e("i",{class:"fas fa-search"})],-1)),S(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>g.value=n),type:"text",class:"search-input",placeholder:"Ketik nama menu atau route...",onInput:Q},null,544),[[G,g.value]]),g.value?(r(),u("div",{key:0,class:"search-clear",onClick:s[2]||(s[2]=n=>g.value="")},[...s[22]||(s[22]=[e("i",{class:"fas fa-times"},null,-1)])])):C("",!0)])]),e("div",Pe,[s[25]||(s[25]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-toggle-on"}),e("span",null,"Status")],-1)),e("div",Te,[(r(!0),u(z,null,X(H.value,n=>(r(),u("button",{key:n.value,class:P(["status-btn",{active:N.value===n.value}]),onClick:Y=>{N.value=n.value,b.value=1}},[e("i",{class:P(n.icon)},null,2),m(" "+i(n.label),1)],10,De))),128))])]),e("div",Ve,[s[28]||(s[28]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-sitemap"}),e("span",null,"Menu Parent")],-1)),e("div",Ie,[S(e("select",{"onUpdate:modelValue":s[3]||(s[3]=n=>T.value=n),class:"parent-select",onChange:s[4]||(s[4]=n=>b.value=1)},[s[26]||(s[26]=e("option",{value:""},"ðŸ“ Semua Menu",-1)),s[27]||(s[27]=e("option",{value:null},"â­ Main Menu",-1)),(r(!0),u(z,null,X(q.value,n=>(r(),u("option",{key:n.id_menu,value:n.id_menu}," ðŸ“‚ "+i(n.nama_menu),9,Fe))),128))],544),[[se,T.value]])])]),e("div",Le,[s[31]||(s[31]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-cog"}),e("span",null,"Aksi")],-1)),e("div",Ee,[e("button",{onClick:k,class:"btn-reset-modern"},[...s[29]||(s[29]=[e("i",{class:"fas fa-redo"},null,-1),e("span",null,"Reset",-1)])]),e("button",{onClick:s[5]||(s[5]=n=>D.value=!0),class:"btn-add-modern"},[...s[30]||(s[30]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"Tambah Menu",-1)])])])])])])]),e("div",Ne,[e("div",je,[e("table",Be,[e("thead",null,[e("tr",null,[e("th",{onClick:s[6]||(s[6]=n=>ee("urutan")),style:{cursor:"pointer"}}," Urutan "+i($.value==="urutan"?A.value==="asc"?"â†‘":"â†“":""),1),e("th",{onClick:s[7]||(s[7]=n=>ee("nama_menu")),style:{cursor:"pointer"}}," Nama Menu "+i($.value==="nama_menu"?A.value==="asc"?"â†‘":"â†“":""),1),s[33]||(s[33]=e("th",null,"Route",-1)),s[34]||(s[34]=e("th",null,"Status",-1)),s[35]||(s[35]=e("th",null,"Actions",-1))])]),e("tbody",null,[a.value.length===0?(r(),u("tr",qe,[...s[36]||(s[36]=[e("td",{colspan:"5",class:"text-center py-4"},[e("i",{class:"fas fa-inbox fa-2x text-muted"}),e("p",{class:"text-muted mt-2"},"Tidak ada data menu")],-1)])])):C("",!0),(r(!0),u(z,null,X(a.value,n=>(r(),u("tr",{key:n.id_menu},[e("td",null,i(n.urutan),1),e("td",null,[e("div",He,[e("span",Ge,i(n.icon||"ðŸ“"),1),e("span",Ke,i(n.nama_menu),1),n.parent?(r(),u("small",Oe,"- "+i(n.parent.nama_menu),1)):C("",!0)])]),e("td",null,[e("code",Je,i(n.route||"-"),1)]),e("td",null,[e("span",{class:P(["badge",n.is_active?"bg-success":"bg-danger"])},i(n.is_active?"Aktif":"Tidak Aktif"),3)]),e("td",null,[e("div",Qe,[e("button",{onClick:Y=>l(n),class:"btn btn-outline-primary btn-sm",title:"Edit"},[...s[37]||(s[37]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"m18.5 2.5 5 5L12 19"}),e("path",{d:"M15 7l-3 3"})],-1)])],8,We),e("button",{onClick:Y=>te(n),class:"btn btn-outline-danger btn-sm",title:"Hapus"},[...s[38]||(s[38]=[ve('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-05682a26><polyline points="3 6 5 6 21 6" data-v-05682a26></polyline><path d="m19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" data-v-05682a26></path><line x1="10" y1="11" x2="10" y2="17" data-v-05682a26></line><line x1="14" y1="11" x2="14" y2="17" data-v-05682a26></line></svg>',1)])],8,ze)])])]))),128))])])]),L.value.length>0?(r(),u("div",Xe,[e("div",Ye,[e("p",Ze,[s[39]||(s[39]=m(" Menampilkan ",-1)),e("strong",null,i(a.value.length),1),s[40]||(s[40]=m(" dari ",-1)),e("strong",null,i(L.value.length),1),s[41]||(s[41]=m(" data ",-1)),L.value.length!==a.value.length?(r(),u("span",es," (Halaman "+i(b.value)+" dari "+i(F.value)+") ",1)):C("",!0)])]),F.value>1?(r(),u("nav",ss,[e("ul",ts,[e("li",{class:P(["page-item",{disabled:b.value===1}])},[e("a",{class:"page-link",href:"#",onClick:s[8]||(s[8]=B(n=>b.value=1,["prevent"]))},"First")],2),e("li",{class:P(["page-item",{disabled:b.value===1}])},[e("a",{class:"page-link",href:"#",onClick:s[9]||(s[9]=B(n=>b.value--,["prevent"]))},"Prev")],2),(r(!0),u(z,null,X(p.value,n=>(r(),u("li",{key:n,class:P(["page-item",{active:b.value===n}])},[e("a",{class:"page-link",href:"#",onClick:B(Y=>b.value=n,["prevent"])},i(n),9,as)],2))),128)),e("li",{class:P(["page-item",{disabled:b.value===F.value}])},[e("a",{class:"page-link",href:"#",onClick:s[10]||(s[10]=B(n=>b.value++,["prevent"]))},"Next")],2),e("li",{class:P(["page-item",{disabled:b.value===F.value}])},[e("a",{class:"page-link",href:"#",onClick:s[11]||(s[11]=B(n=>b.value=F.value,["prevent"]))},"Last")],2)])])):C("",!0)])):C("",!0)]),D.value?(r(),u("div",ls,[e("div",ns,[e("div",os,[e("div",is,[e("h5",rs,i(w.value?"âœï¸ Edit Menu":"âž• Tambah Menu Baru"),1),e("button",{type:"button",class:"btn-close",onClick:U},"Ã—")]),e("div",us,[e("form",{onSubmit:B(W,["prevent"]),class:"menu-form"},[e("div",ds,[e("div",cs,[s[44]||(s[44]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸ·ï¸"),e("span",{class:"label-text"},"Nama Menu"),e("span",{class:"required-mark"},"*")],-1)),e("div",vs,[S(e("input",{"onUpdate:modelValue":s[12]||(s[12]=n=>f.value.nama_menu=n),type:"text",class:P(["form-input-modern",{error:h.value.nama_menu}]),placeholder:"Contoh: Dashboard, Pasien, dll.",required:""},null,2),[[G,f.value.nama_menu]]),s[42]||(s[42]=e("div",{class:"input-icon"},"ðŸ“",-1))]),h.value.nama_menu?(r(),u("div",ms,[s[43]||(s[43]=e("span",{class:"error-icon"},"âš ï¸",-1)),m(" "+i(h.value.nama_menu),1)])):C("",!0)]),e("div",ps,[s[47]||(s[47]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸ”¢"),e("span",{class:"label-text"},"Urutan"),e("span",{class:"required-mark"},"*")],-1)),e("div",fs,[S(e("input",{"onUpdate:modelValue":s[13]||(s[13]=n=>f.value.urutan=n),type:"number",class:P(["form-input-modern",{error:h.value.urutan}]),placeholder:"1",min:"1",required:""},null,2),[[G,f.value.urutan,void 0,{number:!0}]]),s[45]||(s[45]=e("div",{class:"input-icon"},"ðŸ“Š",-1))]),h.value.urutan?(r(),u("div",gs,[s[46]||(s[46]=e("span",{class:"error-icon"},"âš ï¸",-1)),m(" "+i(h.value.urutan),1)])):C("",!0)]),e("div",bs,[s[49]||(s[49]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸŽ¨"),e("span",{class:"label-text"},"Icon")],-1)),e("div",ks,[S(e("input",{"onUpdate:modelValue":s[14]||(s[14]=n=>f.value.icon=n),type:"text",class:"form-input-modern",placeholder:"ðŸ“ atau fas fa-home"},null,512),[[G,f.value.icon]]),s[48]||(s[48]=e("div",{class:"input-icon"},"ðŸŽ¯",-1))]),s[50]||(s[50]=e("div",{class:"help-text-modern"},[e("span",{class:"help-icon"},"ðŸ’¡"),m(" Gunakan emoji (ðŸ“, ðŸ‘¤, ðŸ¥) atau Font Awesome class ")],-1))]),e("div",ys,[s[52]||(s[52]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸ›¤ï¸"),e("span",{class:"label-text"},"Route")],-1)),e("div",$s,[S(e("input",{"onUpdate:modelValue":s[15]||(s[15]=n=>f.value.route=n),type:"text",class:"form-input-modern",placeholder:"/dashboard"},null,512),[[G,f.value.route]]),s[51]||(s[51]=e("div",{class:"input-icon"},"ðŸ”—",-1))])]),e("div",_s,[s[54]||(s[54]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸŒ³"),e("span",{class:"label-text"},"Menu Parent")],-1)),e("div",hs,[S(e("select",{"onUpdate:modelValue":s[16]||(s[16]=n=>f.value.parent_id=n),class:"form-select-modern"},[s[53]||(s[53]=e("option",{value:null},"â­ Main Menu",-1)),(r(!0),u(z,null,X(O.value,n=>(r(),u("option",{key:n.id_menu,value:n.id_menu}," ðŸ“‚ "+i(n.nama_menu),9,ws))),128))],512),[[se,f.value.parent_id]])])]),e("div",Ms,[s[56]||(s[56]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"âš¡"),e("span",{class:"label-text"},"Status")],-1)),e("div",Cs,[e("label",xs,[S(e("input",{"onUpdate:modelValue":s[17]||(s[17]=n=>f.value.is_active=n),type:"checkbox",class:"toggle-input"},null,512),[[me,f.value.is_active]]),s[55]||(s[55]=e("span",{class:"toggle-slider"},[e("span",{class:"toggle-thumb"})],-1)),e("span",Us,[e("span",Rs,i(f.value.is_active?"Aktif":"Tidak Aktif"),1),e("span",Ss,i(f.value.is_active?"âœ…":"âŒ"),1)])])])])])],32)]),e("div",As,[e("button",{type:"button",class:"btn-cancel-modern",onClick:U},[...s[57]||(s[57]=[e("span",{class:"btn-icon"},"âŒ",-1),e("span",{class:"btn-text"},"Batal",-1)])]),e("button",{type:"button",class:"btn-save-modern",onClick:W,disabled:Z(E).loading},[e("span",Ts,[Z(E).loading?(r(),u("span",Vs,[...s[58]||(s[58]=[e("div",{class:"spinner-dots"},[e("span"),e("span"),e("span")],-1)])])):(r(),u("span",Ds,"ðŸ’¾")),e("span",Is,i(w.value?"Update":"Simpan"),1)])],8,Ps)])])])])):C("",!0)])]),V.value?(r(),u("div",{key:0,class:"delete-modal-overlay",onClick:s[20]||(s[20]=B(n=>V.value=!1,["self"]))},[e("div",Fs,[e("div",Ls,[s[59]||(s[59]=e("h5",{class:"delete-modal-title"},"âš ï¸ Konfirmasi Hapus",-1)),e("button",{type:"button",class:"delete-modal-close",onClick:s[18]||(s[18]=n=>V.value=!1)}," Ã— ")]),e("div",Es,[e("div",Ns,[s[62]||(s[62]=e("i",{class:"fas fa-exclamation-triangle delete-icon"},null,-1)),e("p",null,[s[60]||(s[60]=m("Apakah Anda yakin ingin menghapus menu ",-1)),e("strong",null,i((y=d.value)==null?void 0:y.nama_menu),1),s[61]||(s[61]=m("?",-1))])]),(M=d.value)!=null&&M.children&&d.value.children.length>0?(r(),u("div",js,[s[63]||(s[63]=e("i",{class:"fas fa-info-circle"},null,-1)),m(" Menu ini memiliki "+i(d.value.children.length)+" sub-menu. Sub-menu juga akan dihapus! ",1)])):C("",!0)]),e("div",Bs,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[19]||(s[19]=n=>V.value=!1)},[...s[64]||(s[64]=[e("i",{class:"fas fa-times me-2"},null,-1),m("Batal ",-1)])]),e("button",{type:"button",class:"btn btn-danger",onClick:o,disabled:Z(E).loading},[Z(E).loading?(r(),u("span",Hs)):(r(),u("i",Gs)),s[65]||(s[65]=m(" Hapus ",-1))],8,qs)])])])):C("",!0)])}}},Os=ne(Ks,[["__scopeId","data-v-05682a26"]]),Js={class:"role-management-modal-overlay"},Qs={class:"role-management-modal"},Ws={class:"modal-header"},zs={class:"modal-body"},Xs={class:"filter-section-modern"},Ys={class:"filter-content"},Zs={class:"filter-grid"},et={class:"filter-item"},st={class:"search-input-wrapper"},tt={class:"filter-item"},at={class:"status-filter"},lt={class:"filter-item"},nt={class:"action-buttons"},ot={class:"table-section"},it={class:"table-responsive"},rt={class:"table table-modern"},ut={key:0},dt={class:"role-name-cell"},ct={class:"text-muted"},vt={class:"btn-group btn-group-sm"},mt=["onClick"],pt=["onClick"],ft={key:0,class:"pagination-container"},gt={class:"pagination-info"},bt={class:"info-text"},kt={key:0},yt={key:0},$t={class:"pagination"},_t=["onClick"],ht={key:0,class:"role-create-modal-overlay"},wt={class:"modal-dialog modal-lg"},Mt={class:"modal-content"},Ct={class:"modal-header"},xt={class:"modal-title"},Ut={class:"modal-body"},Rt={class:"form-grid"},St={class:"form-group-modern"},At={class:"input-wrapper-modern"},Pt={key:0,class:"error-feedback"},Tt={class:"form-group-modern"},Dt={class:"input-wrapper-modern"},Vt={class:"form-group-modern"},It={class:"toggle-wrapper-modern"},Ft={class:"toggle-switch"},Lt={class:"toggle-label"},Et={class:"toggle-text"},Nt={class:"toggle-icon"},jt={class:"modal-footer"},Bt=["disabled"],qt={key:0,class:"spinner-border spinner-border-sm me-2"},Ht={key:1,class:"fas fa-save me-2"},Gt={class:"delete-modal"},Kt={class:"delete-modal-header"},Ot={class:"delete-modal-body"},Jt={class:"delete-message"},Qt={class:"delete-modal-footer"},Wt=["disabled"],zt={key:0,class:"spinner-border spinner-border-sm me-2"},Xt={key:1,class:"fas fa-trash me-2"},Yt={__name:"RoleManagementModal",emits:["close"],setup(oe,{emit:E}){const g=be(),N=v([]),T=v(!1),b=v(""),I=v(""),$=v(1),A=v(10),D=v(!1),V=v(!1),w=v(!1),j=v(null),f=v({}),h=v({id_role:null,nama_role:"",deskripsi:"",is_active:!0}),d=x(()=>{let k=N.value;return b.value&&(k=k.filter(l=>l.nama_role.toLowerCase().includes(b.value.toLowerCase()))),I.value!==""&&(k=k.filter(l=>l.is_active==I.value)),k}),H=x(()=>{const k=($.value-1)*A.value,l=k+A.value;return d.value.slice(k,l)}),L=x(()=>Math.ceil(d.value.length/A.value)),F=x(()=>{const k=[];let U=Math.max(1,$.value-Math.floor(2.5)),c=Math.min(L.value,U+5-1);c-U+1<5&&(U=Math.max(1,c-5+1));for(let W=U;W<=c;W++)k.push(W);return k}),K=async()=>{T.value=!0;try{console.log("ðŸ” Starting fetchRoles...");const k=await g.fetchAllRoles();console.log("ðŸ“Š Result from store:",k),k.success?(N.value=k.data||[],console.log("âœ… Roles loaded:",N.value)):console.error("âŒ Store returned error:",k.error)}catch(k){console.error("âŒ Error fetching roles:",k),R("Gagal mengambil data role","error")}finally{T.value=!1}},_=()=>{b.value="",I.value="",$.value=1},a=k=>{w.value=!0,h.value={...k},D.value=!0,f.value={}},p=k=>{j.value=k,V.value=!0},q=()=>{D.value=!1,w.value=!1,h.value={id_role:null,nama_role:"",deskripsi:"",is_active:!0},f.value={}},O=()=>(f.value={},h.value.nama_role.trim()||(f.value.nama_role="Nama role wajib diisi"),Object.keys(f.value).length===0),J=async()=>{var k,l;if(O())try{const U={...h.value};let c;w.value?(c=await g.updateRole(U.id_role,U),c.success&&R("Role berhasil diperbarui","success")):(c=await g.createRole(U),c.success&&R("Role berhasil ditambahkan","success")),c.success&&(await K(),q())}catch(U){console.error("Error saving role:",U),R(((l=(k=U.response)==null?void 0:k.data)==null?void 0:l.message)||"Gagal menyimpan role","error")}},Q=async()=>{var k,l;if(j.value)try{(await g.deleteRole(j.value.id_role)).success&&(R("Role berhasil dihapus","success"),await K(),V.value=!1,j.value=null)}catch(U){console.error("Error deleting role:",U),R(((l=(k=U.response)==null?void 0:k.data)==null?void 0:l.message)||"Gagal menghapus role","error")}},ee=k=>k?new Date(k).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}):"-";return le(()=>{K()}),ue($,()=>{window.scrollTo({top:0,behavior:"smooth"})}),(k,l)=>{var U;return r(),u("div",Js,[e("div",Qs,[e("div",Ws,[l[17]||(l[17]=e("h4",null,"ðŸ‘¥ Kelola Role",-1)),e("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=c=>k.$emit("close"))}," Ã— ")]),e("div",zs,[e("div",Xs,[l[26]||(l[26]=e("div",{class:"filter-header"},[e("h5",{class:"filter-title"},[e("i",{class:"fas fa-filter"}),m(" Filter & Pencarian ")])],-1)),e("div",Ys,[e("div",Zs,[e("div",et,[l[20]||(l[20]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-search"}),m(" Cari Role ")],-1)),e("div",st,[l[19]||(l[19]=e("div",{class:"search-icon"},[e("i",{class:"fas fa-search"})],-1)),S(e("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>b.value=c),type:"text",class:"search-input",placeholder:"Masukkan nama role...",onInput:l[2]||(l[2]=c=>$.value=1)},null,544),[[G,b.value]]),b.value?(r(),u("div",{key:0,class:"search-clear",onClick:l[3]||(l[3]=c=>b.value="")},[...l[18]||(l[18]=[e("i",{class:"fas fa-times"},null,-1)])])):C("",!0)])]),e("div",tt,[l[22]||(l[22]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-toggle-on"}),m(" Status ")],-1)),e("div",at,[S(e("select",{"onUpdate:modelValue":l[4]||(l[4]=c=>I.value=c),class:"form-select-modern",onChange:l[5]||(l[5]=c=>$.value=1)},[...l[21]||(l[21]=[e("option",{value:""},"ðŸ” Semua Status",-1),e("option",{value:"1"},"âœ… Aktif",-1),e("option",{value:"0"},"âŒ Tidak Aktif",-1)])],544),[[se,I.value]])])]),e("div",lt,[l[25]||(l[25]=e("div",{class:"filter-label"},[e("i",{class:"fas fa-tools"}),m(" Aksi ")],-1)),e("div",nt,[e("button",{type:"button",class:"btn btn-primary-modern",onClick:l[6]||(l[6]=c=>D.value=!0)},[...l[23]||(l[23]=[e("i",{class:"fas fa-plus"},null,-1),m(" Tambah Role ",-1)])]),e("button",{type:"button",class:"btn btn-secondary-modern",onClick:_},[...l[24]||(l[24]=[e("i",{class:"fas fa-redo"},null,-1),m(" Reset ",-1)])])])])])])]),e("div",ot,[e("div",it,[e("table",rt,[l[30]||(l[30]=e("thead",null,[e("tr",null,[e("th",{width:"50"},"#"),e("th",{width:"200"},"Nama Role"),e("th",{width:"100"},"Status"),e("th",{width:"150"},"Dibuat"),e("th",{width:"120"},"Aksi")])],-1)),e("tbody",null,[d.value.length===0?(r(),u("tr",ut,[...l[27]||(l[27]=[e("td",{colspan:"5",class:"text-center text-muted py-4"},[e("i",{class:"fas fa-search fa-2x mb-2"}),e("p",null,"Tidak ada role yang ditemukan")],-1)])])):C("",!0),(r(!0),u(z,null,X(H.value,(c,W)=>(r(),u("tr",{key:c.id_role},[e("td",null,i(($.value-1)*A.value+W+1),1),e("td",null,[e("div",dt,[e("strong",null,i(c.nama_role),1)])]),e("td",null,[e("span",{class:P(["status-badge",c.is_active?"status-active":"status-inactive"])},[e("i",{class:P(["fas",c.is_active?"fa-check-circle":"fa-times-circle"])},null,2),m(" "+i(c.is_active?"Aktif":"Tidak Aktif"),1)],2)]),e("td",null,[e("small",ct,i(ee(c.created_at)),1)]),e("td",null,[e("div",vt,[e("button",{onClick:te=>a(c),class:"btn btn-outline-primary btn-sm",title:"Edit"},[...l[28]||(l[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"m18.5 2.5 5 5L12 19"}),e("path",{d:"M15 7l-3 3"})],-1)])],8,mt),e("button",{onClick:te=>p(c),class:"btn btn-outline-danger btn-sm",title:"Hapus"},[...l[29]||(l[29]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})],-1)])],8,pt)])])]))),128))])])]),d.value.length>0?(r(),u("div",ft,[e("div",gt,[e("p",bt,[l[31]||(l[31]=m(" Menampilkan ",-1)),e("strong",null,i(H.value.length),1),l[32]||(l[32]=m(" dari ",-1)),e("strong",null,i(d.value.length),1),l[33]||(l[33]=m(" data ",-1)),d.value.length!==H.value.length?(r(),u("span",kt," (Halaman "+i($.value)+" dari "+i(L.value)+") ",1)):C("",!0)])]),L.value>1?(r(),u("nav",yt,[e("ul",$t,[e("li",{class:P(["page-item",{disabled:$.value===1}])},[e("a",{class:"page-link",href:"#",onClick:l[7]||(l[7]=B(c=>$.value=1,["prevent"]))},"First")],2),e("li",{class:P(["page-item",{disabled:$.value===1}])},[e("a",{class:"page-link",href:"#",onClick:l[8]||(l[8]=B(c=>$.value--,["prevent"]))},"Prev")],2),(r(!0),u(z,null,X(F.value,c=>(r(),u("li",{key:c,class:P(["page-item",{active:$.value===c}])},[e("a",{class:"page-link",href:"#",onClick:B(W=>$.value=c,["prevent"])},i(c),9,_t)],2))),128)),e("li",{class:P(["page-item",{disabled:$.value===L.value}])},[e("a",{class:"page-link",href:"#",onClick:l[9]||(l[9]=B(c=>$.value++,["prevent"]))},"Next")],2),e("li",{class:P(["page-item",{disabled:$.value===L.value}])},[e("a",{class:"page-link",href:"#",onClick:l[10]||(l[10]=B(c=>$.value=L.value,["prevent"]))},"Last")],2)])])):C("",!0)])):C("",!0)])])]),D.value?(r(),u("div",ht,[e("div",wt,[e("div",Mt,[e("div",Ct,[e("h5",xt,[e("i",{class:P(["fas",w.value?"fa-edit":"fa-plus"])},null,2),m(" "+i(w.value?"Edit Role":"Tambah Role Baru"),1)]),e("button",{type:"button",class:"btn-close",onClick:q}," Ã— ")]),e("div",Ut,[e("form",{onSubmit:B(J,["prevent"]),class:"modern-form"},[e("div",Rt,[e("div",St,[l[35]||(l[35]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸ‘¤"),e("span",{class:"label-text"},"Nama Role")],-1)),e("div",At,[S(e("input",{"onUpdate:modelValue":l[11]||(l[11]=c=>h.value.nama_role=c),type:"text",class:P(["form-input-modern",{"is-invalid":f.value.nama_role}]),placeholder:"Contoh: Administrator"},null,2),[[G,h.value.nama_role]]),l[34]||(l[34]=e("div",{class:"input-icon"},"ðŸ·ï¸",-1))]),f.value.nama_role?(r(),u("div",Pt,i(f.value.nama_role),1)):C("",!0)]),e("div",Tt,[l[37]||(l[37]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"ðŸ“"),e("span",{class:"label-text"},"Deskripsi")],-1)),e("div",Dt,[S(e("textarea",{"onUpdate:modelValue":l[12]||(l[12]=c=>h.value.deskripsi=c),class:"form-input-modern",placeholder:"Deskripsi role...",rows:"3"},null,512),[[G,h.value.deskripsi]]),l[36]||(l[36]=e("div",{class:"input-icon"},"ðŸ“„",-1))])]),e("div",Vt,[l[39]||(l[39]=e("label",{class:"form-label-modern"},[e("span",{class:"label-icon"},"âš¡"),e("span",{class:"label-text"},"Status Role")],-1)),e("div",It,[e("label",Ft,[S(e("input",{"onUpdate:modelValue":l[13]||(l[13]=c=>h.value.is_active=c),type:"checkbox",class:"toggle-input"},null,512),[[me,h.value.is_active]]),l[38]||(l[38]=e("span",{class:"toggle-slider"},[e("span",{class:"toggle-thumb"})],-1)),e("span",Lt,[e("span",Et,i(h.value.is_active?"Aktif":"Tidak Aktif"),1),e("span",Nt,i(h.value.is_active?"âœ…":"âŒ"),1)])])])])])],32)]),e("div",jt,[e("button",{type:"button",class:"btn btn-secondary",onClick:q},[...l[40]||(l[40]=[e("i",{class:"fas fa-times me-2"},null,-1),m("Batal ",-1)])]),e("button",{type:"button",class:"btn btn-primary",onClick:J,disabled:Z(g).loading},[Z(g).loading?(r(),u("span",qt)):(r(),u("i",Ht)),m(" "+i(w.value?"Update":"Simpan"),1)],8,Bt)])])])])):C("",!0),V.value?(r(),u("div",{key:1,class:"delete-modal-overlay",onClick:l[16]||(l[16]=B(c=>V.value=!1,["self"]))},[e("div",Gt,[e("div",Kt,[l[41]||(l[41]=e("h5",{class:"delete-modal-title"},"âš ï¸ Konfirmasi Hapus",-1)),e("button",{type:"button",class:"delete-modal-close",onClick:l[14]||(l[14]=c=>V.value=!1)}," Ã— ")]),e("div",Ot,[e("div",Jt,[l[44]||(l[44]=e("i",{class:"fas fa-exclamation-triangle delete-icon"},null,-1)),e("p",null,[l[42]||(l[42]=m("Apakah Anda yakin ingin menghapus role ",-1)),e("strong",null,i((U=j.value)==null?void 0:U.nama_role),1),l[43]||(l[43]=m("?",-1))])])]),e("div",Qt,[e("button",{type:"button",class:"btn btn-secondary",onClick:l[15]||(l[15]=c=>V.value=!1)},[...l[45]||(l[45]=[e("i",{class:"fas fa-times me-2"},null,-1),m("Batal ",-1)])]),e("button",{type:"button",class:"btn btn-danger",onClick:Q,disabled:Z(g).loading},[Z(g).loading?(r(),u("span",zt)):(r(),u("i",Xt)),l[46]||(l[46]=m(" Hapus ",-1))],8,Wt)])])])):C("",!0)])}}},Zt=ne(Yt,[["__scopeId","data-v-236058ba"]]),ea={class:"user-management-modal-overlay"},sa={class:"user-management-modal"},ta={class:"modal-header"},aa={class:"modal-body"},la={class:"filter-section-modern"},na={class:"filter-header"},oa={class:"filter-actions"},ia={class:"filter-content"},ra={class:"filter-row"},ua={class:"filter-group"},da={class:"input-with-icon"},ca={class:"filter-group"},va={class:"input-with-icon"},ma=["value"],pa={class:"filter-group"},fa={class:"input-with-icon"},ga={class:"table-responsive-modern"},ba={class:"table-modern"},ka={key:0},ya={key:1},$a=["onClick"],_a={class:"user-info"},ha={class:"user-details"},wa={class:"user-name"},Ma={class:"user-nip"},Ca={class:"user-username"},xa={class:"user-role"},Ua={class:"action-buttons"},Ra=["onClick"],Sa=["onClick"],Aa={class:"pagination-wrapper"},Pa={class:"pagination-info"},Ta={class:"pagination-controls"},Da=["disabled"],Va={class:"page-info"},Ia=["disabled"],Fa={key:0,class:"user-create-modal-overlay"},La={class:"modal-dialog modal-lg"},Ea={class:"modal-content"},Na={class:"modal-header"},ja={class:"modal-title"},Ba={class:"modal-body"},qa={class:"form-grid"},Ha={class:"form-group"},Ga={class:"form-group"},Ka={class:"form-group"},Oa={class:"form-group"},Ja=["placeholder","required"],Qa={class:"form-group"},Wa=["value"],za={class:"form-group"},Xa={class:"status-options"},Ya={class:"status-option"},Za={class:"status-option"},el={class:"form-actions"},sl=["disabled"],ae=10,tl={__name:"UserManagementModal",emits:["close"],setup(oe,{emit:E}){const g=ke(),N=_e(),T=x(()=>g.users),b=v(!1),I=v(""),$=v(""),A=v(""),D=v(1),V=v(!1),w=v(!1),j=v(!1),f=v([]),h=v(!1),d=v({id_user:null,nama:"",nip:"",username:"",password:"",id_role:"",originalRole:"",status:"1"}),H=x(()=>{let o=T.value||[];if(I.value){const t=I.value.toLowerCase();o=o.filter(s=>{var y,M,n;return((y=s.nama)==null?void 0:y.toLowerCase().includes(t))||((M=s.username)==null?void 0:M.toLowerCase().includes(t))||((n=s.nip)==null?void 0:n.toLowerCase().includes(t))})}return $.value&&(o=o.filter(t=>t.id_role==$.value)),A.value&&(o=o.filter(t=>t.status==A.value)),o}),L=x(()=>{const o=(D.value-1)*ae,t=o+ae;return H.value.slice(o,t)}),F=x(()=>Math.ceil(H.value.length/ae)||1),K=x(()=>(D.value-1)*ae),_=x(()=>Math.min(K.value+L.value.length,H.value.length)),a=x(()=>!b.value&&h.value&&T.value.length>0),p=x(()=>a.value?L.value:[]),q=o=>new Promise(t=>setTimeout(t,o)),O=async(o,t=5,s=2e3)=>{for(let y=1;y<=t;y++)try{console.log(`ðŸ”„ Attempt ${y}/${t}...`);const M=await o();if(M&&M.error&&M.error.includes("Too Many"))throw new Error("Rate limited");return console.log("âœ… Request successful"),M}catch(M){if(y===t)throw console.error("âŒ Max retries reached"),M;const n=s*Math.pow(2,y-1);console.log(`â³ Rate limited, waiting ${n}ms before retry...`),await q(n)}},J=async()=>{try{console.log("ðŸ” Fetching roles...");const o=await O(()=>N.fetchAllRoles());o.success&&(f.value=o.data||[],console.log("âœ… Roles loaded:",f.value))}catch(o){console.error("âŒ Failed to fetch roles after retries:",o),R("Gagal mengambil data role","error")}},Q=async()=>{b.value=!0;try{console.log("ðŸ” Starting fetchUsers...");const o=await O(()=>g.fetchAllUsers());console.log("ðŸ“Š Result from store:",o),o.success&&(console.log("âœ… Users loaded via store:",g.users),ee())}catch(o){console.error("âŒ Failed to fetch users after retries:",o),R("Gagal mengambil data user","error")}finally{b.value=!1}},ee=async()=>{try{console.log("ðŸŽ­ Using backend role data from LEFT JOIN query...");const o=g.users;console.log(`ðŸ“‹ Using role data for ${o.length} users from backend`),h.value=!0,console.log("âœ… Role data ready from backend LEFT JOIN query")}catch(o){console.error("âŒ Error processing user roles:",o),h.value=!0}},k=()=>{I.value="",$.value="",A.value="",D.value=1},l=()=>{d.value={id_user:null,nama:"",nip:"",username:"",password:"",id_role:"",originalRole:"",status:"1"},w.value=!1},U=()=>{V.value=!1,l()},c=async o=>{console.log("âœï¸ Editing user:",o),console.log("ðŸ“‹ User properties:",Object.keys(o));let t={id_role:1,nama_role:"Administrator"};if(o.nip&&o.nip!=="-")try{console.log(`ðŸ” Fetching current role for ${o.nip}...`);const s=await ye.getPegawaiAccessLevels(o.nip);if(s.data&&s.data.length>0){const y=s.data[0];t={id_role:y.id_role,nama_role:y.nama_role},console.log(`âœ… Found current role for ${o.nip}:`,t.nama_role)}else console.log(`âš ï¸ No role found for ${o.nip}, using default Administrator`)}catch(s){console.error(`âŒ Error fetching role for ${o.nip}:`,s),console.log(`âš ï¸ Using default Administrator role for ${o.nip}`)}d.value={id_user:o.id_user||o.nip,nama:o.nama||"",nip:o.nip||"",username:o.username||o.nip||"",password:"",id_role:t.id_role.toString(),originalRole:t.id_role.toString(),status:o.status!==void 0?o.status.toString():"1"},console.log("ðŸ“ User form set to:",d.value),console.log(`ðŸŽ¯ Using role: ${t.nama_role} (${t.id_role})`),w.value=!0,V.value=!0,console.log("ðŸ”“ Modal should open now. isEditing:",w.value,"showCreateModal:",V.value)},W=async()=>{j.value=!0;try{console.log("ðŸ’¾ Saving user:",d.value),console.log("ðŸ”§ isEditing:",w.value),console.log("ðŸ†” User ID:",d.value.id_user);let o;if(w.value){const t=parseInt(d.value.id_role),s=parseInt(d.value.originalRole);if(console.log("ðŸ” Debug role update check:",{currentRole:d.value.id_role,originalRole:d.value.originalRole,currentRoleInt:t,originalRoleInt:s,areEqual:t===s,formIdUser:d.value.id_user}),d.value.id_role&&t!==s){console.log("ðŸ” Updating role:",d.value.id_role,"from:",d.value.originalRole);try{const y=await N.assignRoleToPegawai(d.value.id_user,d.value.id_role,d.value.id_user);console.log("ðŸ” Role update result:",y),y.success?(console.log("âœ… Role assignment successful!"),R("Role berhasil diperbarui","success"),setTimeout(()=>{const M=T.value.findIndex(n=>n.id_user===d.value.id_user||n.nip===d.value.id_user);if(M!==-1){const n=f.value.find(Y=>Y.id_role===parseInt(d.value.id_role));if(n){const Y={...T.value[M],id_role:parseInt(d.value.id_role),role_name:n.nama_role},ie=g.users.findIndex(de=>de.id_user===d.value.id_user||de.nip===d.value.id_user);ie!==-1&&(g.users=[...g.users.slice(0,ie),Y,...g.users.slice(ie+1)],console.log("âœ… Updated user role immediately:",Y),console.log(`ðŸ“‹ Role changed: ${n.nama_role} (ID: ${n.id_role})`))}}},100),setTimeout(()=>{Q().catch(M=>{console.warn("Background refresh failed, but UI already updated:",M)})},500),o={success:!0}):(R(y.error||"Gagal mengupdate role","error"),o={success:!1})}catch(y){console.error("ðŸš¨ Role assignment error:",y),R("Gagal mengupdate role","error"),o={success:!1}}}else console.log("â„¹ï¸ No role change detected"),R("Tidak ada perubahan role","info"),o={success:!0}}else o=await g.createUser(d.value);console.log("ðŸ“Š Final save result:",o),o.success?(R(w.value?"User berhasil diupdate!":"User berhasil ditambahkan!","success"),U(),await Q()):(console.error("âŒ Save failed:",o.error),R(o.error||"Gagal menyimpan user","error"))}catch(o){console.error("ðŸš¨ Error saving user:",o),console.error("ðŸš¨ Error response:",o.response),R("Terjadi kesalahan saat menyimpan user","error")}finally{j.value=!1}},te=async o=>{if(confirm(`Apakah Anda yakin ingin menghapus user "${o.nama}"?`))try{const t=await g.deleteUser(o.id_user);t.success?(R("User berhasil dihapus!","success"),await Q()):R(t.error||"Gagal menghapus user","error")}catch(t){console.error("Error deleting user:",t),R("Terjadi kesalahan saat menghapus user","error")}};return le(async()=>{h.value=!1,b.value=!0,console.log("ðŸ”„ Starting user management modal load...");const o=Date.now();try{console.log("ðŸ“‹ Step 1: Fetching roles data..."),await J(),console.log(`âœ… Roles loaded: ${f.value.length} roles`),console.log("ðŸ“‹ Step 2: Fetching users data..."),await Q(),console.log(`âœ… Users loaded: ${g.users.length} users`),console.log("ðŸ“‹ Step 3: Fetching user role assignments..."),await ee(),console.log("âœ… Role assignments completed");const t=Date.now()-o,y=Math.max(0,1200-t);y>0&&(console.log(`â³ Adding ${y}ms for consistent loading...`),await new Promise(M=>setTimeout(M,y))),console.log(`ðŸŽ‰ All data loaded successfully in ${Date.now()-o}ms`)}catch(t){console.error("âŒ Error loading user management data:",t),R("Gagal memuat data user management","error")}finally{b.value=!1,console.log("âœ… Loading state set to false")}}),ue(D,()=>{window.scrollTo({top:0,behavior:"smooth"})}),(o,t)=>(r(),u("div",ea,[e("div",sa,[e("div",ta,[t[14]||(t[14]=e("h4",null,"ðŸ‘¥ Kelola User",-1)),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=s=>o.$emit("close"))}," Ã— ")]),e("div",aa,[e("div",la,[e("div",na,[t[17]||(t[17]=e("h5",{class:"filter-title"},[e("i",{class:"fas fa-filter"}),m(" Filter & Pencarian ")],-1)),e("div",oa,[e("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:k},[...t[15]||(t[15]=[e("i",{class:"fas fa-undo"},null,-1),m(" Reset ",-1)])]),e("button",{type:"button",class:"btn btn-primary btn-sm",onClick:t[1]||(t[1]=s=>V.value=!0)},[...t[16]||(t[16]=[e("i",{class:"fas fa-plus"},null,-1),m(" Tambah User Baru ",-1)])])])]),e("div",ia,[e("div",ra,[e("div",ua,[e("div",da,[t[18]||(t[18]=e("i",{class:"fas fa-search"},null,-1)),S(e("input",{type:"text",class:"form-control",placeholder:"Cari berdasarkan nama, username, atau NIP...","onUpdate:modelValue":t[2]||(t[2]=s=>I.value=s)},null,512),[[G,I.value]])])]),e("div",ca,[e("div",va,[t[20]||(t[20]=e("i",{class:"fas fa-user-tag"},null,-1)),S(e("select",{class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>$.value=s)},[t[19]||(t[19]=e("option",{value:""},"Semua Role",-1)),(r(!0),u(z,null,X(f.value,s=>(r(),u("option",{key:s.id_role,value:s.id_role},i(s.nama_role),9,ma))),128))],512),[[se,$.value]])])]),e("div",pa,[e("div",fa,[t[22]||(t[22]=e("i",{class:"fas fa-toggle-on"},null,-1)),S(e("select",{class:"form-control","onUpdate:modelValue":t[4]||(t[4]=s=>A.value=s)},[...t[21]||(t[21]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"1"},"Aktif",-1),e("option",{value:"0"},"Tidak Aktif",-1)])],512),[[se,A.value]])])])])])]),e("div",ga,[e("table",ba,[t[28]||(t[28]=e("thead",null,[e("tr",null,[e("th",null,[e("div",{class:"table-header-content"},[e("span",null,"Informasi User"),e("i",{class:"fas fa-sort sort-icon"})])]),e("th",null,[e("div",{class:"table-header-content"},[e("span",null,"Username"),e("i",{class:"fas fa-sort sort-icon"})])]),e("th",null,[e("div",{class:"table-header-content"},[e("span",null,"Role"),e("i",{class:"fas fa-sort sort-icon"})])]),e("th",null,[e("div",{class:"table-header-content"},[e("span",null,"Status"),e("i",{class:"fas fa-sort sort-icon"})])]),e("th",null,[e("div",{class:"table-header-content"},[e("span",null,"Aksi")])])])],-1)),e("tbody",null,[b.value?(r(),u("tr",ka,[...t[23]||(t[23]=[e("td",{colspan:"5",class:"text-center"},[e("div",{class:"loading-container"},[e("div",{class:"loading-spinner"},[e("div",{class:"spinner"}),e("div",{class:"loading-text"},[e("div",{class:"loading-title"},"Memuat Data User Management"),e("div",{class:"loading-subtitle"},"Sedang menyiapkan data pengguna dan role...")])])])],-1)])])):!b.value&&L.value.length===0?(r(),u("tr",ya,[...t[24]||(t[24]=[e("td",{colspan:"5",class:"text-center"},[e("div",{class:"empty-state"},[e("i",{class:"fas fa-users"}),e("span",null,"Tidak ada data user")])],-1)])])):C("",!0),(r(!0),u(z,null,X(p.value,s=>(r(),u("tr",{key:s.id_user,class:"table-row-hover",onClick:y=>console.log("User clicked:",s)},[e("td",null,[e("div",_a,[t[25]||(t[25]=e("div",{class:"user-avatar"},[e("i",{class:"fas fa-user"})],-1)),e("div",ha,[e("div",wa,i(s.nama),1),e("div",Ma,i(s.nip),1)])])]),e("td",null,[e("span",Ca,"@"+i(s.username),1)]),e("td",null,[e("span",xa,i(s.role_name||"Administrator"),1)]),e("td",null,[e("span",{class:P(["user-status",s.status==1?"status-active":"status-inactive"])},i(s.status==1?"Aktif":"Tidak Aktif"),3)]),e("td",null,[e("div",Ua,[e("button",{type:"button",class:"btn-icon btn-edit",onClick:y=>c(s),title:"Edit User"},[...t[26]||(t[26]=[e("i",{class:"fas fa-edit"},"âœï¸",-1)])],8,Ra),e("button",{type:"button",class:"btn-icon btn-delete",onClick:y=>te(s),title:"Hapus User"},[...t[27]||(t[27]=[e("i",{class:"fas fa-trash"},"ðŸ—‘ï¸",-1)])],8,Sa)])])],8,$a))),128))])])]),e("div",Aa,[e("div",Pa," Menampilkan "+i(K.value+1)+"-"+i(_.value)+" dari "+i(H.value.length)+" user ",1),e("div",Ta,[e("button",{class:"btn btn-outline-secondary btn-sm",disabled:D.value===1,onClick:t[5]||(t[5]=s=>D.value--)},[...t[29]||(t[29]=[e("i",{class:"fas fa-chevron-left"},null,-1),m(" Previous ",-1)])],8,Da),e("span",Va,"Halaman "+i(D.value)+" dari "+i(F.value),1),e("button",{class:"btn btn-outline-secondary btn-sm",disabled:D.value===F.value,onClick:t[6]||(t[6]=s=>D.value++)},[...t[30]||(t[30]=[m(" Next ",-1),e("i",{class:"fas fa-chevron-right"},null,-1)])],8,Ia)])])])]),V.value?(r(),u("div",Fa,[e("div",La,[e("div",Ea,[e("div",Na,[e("h5",ja,[e("i",{class:P(["fas",w.value?"fa-edit":"fa-plus"])},null,2),m(" "+i(w.value?"Edit User":"Tambah User Baru"),1)]),e("button",{type:"button",class:"btn-close",onClick:U}," Ã— ")]),e("div",Ba,[e("form",{onSubmit:B(W,["prevent"]),class:"modern-form"},[e("div",qa,[e("div",Ha,[t[31]||(t[31]=e("label",{class:"form-label"},[e("i",{class:"fas fa-user"}),m(" Nama Lengkap ")],-1)),S(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=s=>d.value.nama=s),placeholder:"Masukkan nama lengkap user",required:""},null,512),[[G,d.value.nama]])]),e("div",Ga,[t[32]||(t[32]=e("label",{class:"form-label"},[e("i",{class:"fas fa-id-card"}),m(" NIP ")],-1)),S(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>d.value.nip=s),placeholder:"Masukkan NIP user",required:""},null,512),[[G,d.value.nip]])]),e("div",Ka,[t[33]||(t[33]=e("label",{class:"form-label"},[e("i",{class:"fas fa-at"}),m(" Username ")],-1)),S(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=s=>d.value.username=s),placeholder:"Masukkan username",required:""},null,512),[[G,d.value.username]])]),e("div",Oa,[t[34]||(t[34]=e("label",{class:"form-label"},[e("i",{class:"fas fa-lock"}),m(" Password ")],-1)),S(e("input",{type:"password",class:"form-control","onUpdate:modelValue":t[10]||(t[10]=s=>d.value.password=s),placeholder:w.value?"Kosongkan jika tidak mengubah":"Masukkan password",required:!w.value},null,8,Ja),[[G,d.value.password]])]),e("div",Qa,[t[36]||(t[36]=e("label",{class:"form-label"},[e("i",{class:"fas fa-user-tag"}),m(" Role ")],-1)),S(e("select",{class:"form-control","onUpdate:modelValue":t[11]||(t[11]=s=>d.value.id_role=s),required:""},[t[35]||(t[35]=e("option",{value:""},"Pilih Role",-1)),(r(!0),u(z,null,X(f.value,s=>(r(),u("option",{key:s.id_role,value:s.id_role},i(s.nama_role),9,Wa))),128))],512),[[se,d.value.id_role]])])]),e("div",za,[t[39]||(t[39]=e("label",{class:"form-label"},[e("i",{class:"fas fa-toggle-on"}),m(" Status User ")],-1)),e("div",Xa,[e("label",Ya,[S(e("input",{type:"radio","onUpdate:modelValue":t[12]||(t[12]=s=>d.value.status=s),value:"1",required:""},null,512),[[ce,d.value.status]]),t[37]||(t[37]=e("span",{class:"status-label status-active"},"Aktif",-1))]),e("label",Za,[S(e("input",{type:"radio","onUpdate:modelValue":t[13]||(t[13]=s=>d.value.status=s),value:"0",required:""},null,512),[[ce,d.value.status]]),t[38]||(t[38]=e("span",{class:"status-label status-inactive"},"Tidak Aktif",-1))])])]),e("div",el,[e("button",{type:"button",class:"btn btn-secondary",onClick:U},[...t[40]||(t[40]=[e("i",{class:"fas fa-times"},null,-1),m(" Batal ",-1)])]),e("button",{type:"submit",class:"btn btn-primary",disabled:j.value},[t[41]||(t[41]=e("i",{class:"fas fa-save"},null,-1)),m(" "+i(j.value?"Menyimpan...":w.value?"Update User":"Simpan User"),1)],8,sl)])],32)])])])])):C("",!0)]))}},al=ne(tl,[["__scopeId","data-v-33588047"]]),ll={class:"dashboard-page"},nl={class:"dashboard-main"},ol={class:"welcome-section"},il={class:"welcome-content"},rl={class:"welcome-text"},ul={class:"user-badges"},dl={class:"user-badge"},cl={class:"badge-text"},vl={class:"department-badge"},ml={class:"dept-text"},pl={class:"date-time-info"},fl={class:"date-time"},gl={class:"stats-section"},bl={class:"stats-grid"},kl={class:"stat-card"},yl={class:"stat-content"},$l={class:"stat-card"},_l={class:"stat-content"},hl={class:"stat-card"},wl={class:"stat-content"},Ml={class:"stat-card"},Cl={class:"stat-content"},xl={class:"dashboard-sections"},Ul={class:"quick-actions-section"},Rl={class:"actions-grid"},Sl={class:"recent-activities-section"},Al={class:"activities-list"},Pl={class:"activity-content"},Tl={class:"activity-text"},Dl={class:"activity-time"},Vl={__name:"DashboardView",setup(oe){const E=fe(),g=$e(),N=v(""),T=v(null),b=v(!1),I=v(!1),$=v(!1),A=v({totalPatients:2847,todayVisits:156,emergencyCases:23,surgeries:8}),D=v([{id:1,type:"patient",description:"Pasien baru terdaftar: John Doe (RM: 2024001)",time:"5 menit yang lalu"},{id:2,type:"emergency",description:"Kasus IGD baru: Trauma kepala",time:"12 menit yang lalu"},{id:3,type:"surgery",description:"Operasi selesai: Apendisitis",time:"1 jam yang lalu"},{id:4,type:"lab",description:"Hasil lab siap: Darah lengkap",time:"2 jam yang lalu"},{id:5,type:"pharmacy",description:"Resep disiapkan: Antibiotik",time:"3 jam yang lalu"}]);x(()=>{var a,p,q;return(((q=(p=(a=g.user)==null?void 0:a.data)==null?void 0:p.detail)==null?void 0:q.nama)||g.userName||"User").split(" ").map(O=>O[0]).join("").toUpperCase().slice(0,2)});const V=x(()=>{var p,q,O,J;if(!((q=(p=g.user)==null?void 0:p.data)!=null&&q.detail))return(((O=g.userName)==null?void 0:O.toLowerCase())||"").includes("admin")?"Administrator":"Staff";const _=g.user.data.detail;if(_.jbtn)return _.jbtn;if(_.departemen)return _.departemen;const a=((J=_.nama)==null?void 0:J.toLowerCase())||"";return a.includes("admin")?"Administrator":a.includes("dokter")?"Dokter":a.includes("perawat")?"Perawat":a.includes("farmasi")?"Farmasi":"Staff"}),w=x(()=>{var _,a,p;return((p=(a=(_=g.user)==null?void 0:_.data)==null?void 0:a.detail)==null?void 0:p.nama)||g.userName||"User"}),j=x(()=>{var _,a,p;return((p=(a=(_=g.user)==null?void 0:_.data)==null?void 0:a.detail)==null?void 0:p.departemen)||"Unknown"}),f=x(()=>{var _,a,p;return((p=(a=(_=g.user)==null?void 0:_.data)==null?void 0:a.detail)==null?void 0:p.jbtn)||V.value}),h=x(()=>{const _=f.value.toLowerCase(),a=w.value.toLowerCase();return _.includes("admin")||_.includes("koordinator")||a.includes("admin")||_.includes("ti")}),d=x(()=>{const _=new Date().getHours();return _<12?"Selamat pagi! Semoga hari Anda menyenangkan.":_<17?"Selamat siang! Jaga kesehatan Anda.":"Selamat malam! Jangan lupa istirahat."}),H=()=>{const _=new Date,a={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"};N.value=_.toLocaleDateString("id-ID",a)},L=_=>({patient:"ðŸ‘¤",emergency:"ðŸš‘",surgery:"âš•ï¸",lab:"ðŸ§ª",pharmacy:"ðŸ’Š"})[_]||"ðŸ“",F=_=>{console.log(`Navigating to ${_} module`)},K=()=>{E.push("/admin/role-menu")};return le(()=>{H(),T.value=setInterval(H,1e3)}),pe(()=>{T.value&&clearInterval(T.value)}),(_,a)=>(r(),u("div",ll,[e("main",nl,[e("section",ol,[e("div",il,[e("div",rl,[e("h2",null,"Selamat datang, "+i(w.value)+"! ðŸ‘‹",1),e("p",null,i(d.value),1),e("div",ul,[e("div",dl,[e("span",cl,i(f.value),1)]),e("div",vl,[e("span",ml,i(j.value),1)])])]),e("div",pl,[e("div",fl,i(N.value),1),a[17]||(a[17]=e("div",{class:"session-info"},"Sesi aktif",-1))])])]),e("section",gl,[e("div",bl,[e("div",kl,[a[20]||(a[20]=e("div",{class:"stat-icon patients"},"ðŸ‘¥",-1)),e("div",yl,[e("h3",null,i(A.value.totalPatients),1),a[18]||(a[18]=e("p",null,"Total Pasien",-1)),a[19]||(a[19]=e("span",{class:"stat-trend positive"},"+12% dari bulan lalu",-1))])]),e("div",$l,[a[23]||(a[23]=e("div",{class:"stat-icon today-visits"},"ðŸ¥",-1)),e("div",_l,[e("h3",null,i(A.value.todayVisits),1),a[21]||(a[21]=e("p",null,"Kunjungan Hari Ini",-1)),a[22]||(a[22]=e("span",{class:"stat-trend positive"},"+8% dari kemarin",-1))])]),e("div",hl,[a[26]||(a[26]=e("div",{class:"stat-icon emergency"},"ðŸš‘",-1)),e("div",wl,[e("h3",null,i(A.value.emergencyCases),1),a[24]||(a[24]=e("p",null,"Kasus IGD",-1)),a[25]||(a[25]=e("span",{class:"stat-trend negative"},"-3% dari rata-rata",-1))])]),e("div",Ml,[a[29]||(a[29]=e("div",{class:"stat-icon surgeries"},"âš•ï¸",-1)),e("div",Cl,[e("h3",null,i(A.value.surgeries),1),a[27]||(a[27]=e("p",null,"Jadwal Operasi",-1)),a[28]||(a[28]=e("span",{class:"stat-trend neutral"},"Sama dengan kemarin",-1))])])])]),e("section",xl,[e("div",Ul,[a[44]||(a[44]=e("h3",null,"Akses Cepat",-1)),e("div",Rl,[e("button",{onClick:a[0]||(a[0]=p=>b.value=!0),class:"action-btn"},[...a[30]||(a[30]=[e("span",{class:"action-icon"},"ðŸ“‹",-1),e("span",{class:"action-label"},"Kelola Menu",-1)])]),e("button",{onClick:a[1]||(a[1]=p=>I.value=!0),class:"action-btn"},[...a[31]||(a[31]=[e("span",{class:"action-icon"},"ðŸ‘¥",-1),e("span",{class:"action-label"},"Kelola Role",-1)])]),e("button",{onClick:a[2]||(a[2]=p=>$.value=!0),class:"action-btn"},[...a[32]||(a[32]=[e("span",{class:"action-icon"},"ðŸ‘¤",-1),e("span",{class:"action-label"},"Kelola User",-1)])]),e("button",{onClick:a[3]||(a[3]=p=>F("pasien")),class:"action-btn"},[...a[33]||(a[33]=[e("span",{class:"action-icon"},"ðŸ¥",-1),e("span",{class:"action-label"},"Data Pasien",-1)])]),e("button",{onClick:a[4]||(a[4]=p=>F("pemeriksaan")),class:"action-btn"},[...a[34]||(a[34]=[e("span",{class:"action-icon"},"ðŸ”¬",-1),e("span",{class:"action-label"},"Pemeriksaan",-1)])]),e("button",{onClick:a[5]||(a[5]=p=>F("farmasi")),class:"action-btn"},[...a[35]||(a[35]=[e("span",{class:"action-icon"},"ðŸ’Š",-1),e("span",{class:"action-label"},"Farmasi",-1)])]),e("button",{onClick:a[6]||(a[6]=p=>F("laboratorium")),class:"action-btn"},[...a[36]||(a[36]=[e("span",{class:"action-icon"},"ðŸ§ª",-1),e("span",{class:"action-label"},"Laboratorium",-1)])]),e("button",{onClick:a[7]||(a[7]=p=>F("radiologi")),class:"action-btn"},[...a[37]||(a[37]=[e("span",{class:"action-icon"},"ðŸ“·",-1),e("span",{class:"action-label"},"Radiologi",-1)])]),e("button",{onClick:a[8]||(a[8]=p=>F("keuangan")),class:"action-btn"},[...a[38]||(a[38]=[e("span",{class:"action-icon"},"ðŸ’°",-1),e("span",{class:"action-label"},"Keuangan",-1)])]),e("button",{onClick:a[9]||(a[9]=p=>F("bpjs")),class:"action-btn"},[...a[39]||(a[39]=[e("span",{class:"action-icon"},"ðŸ›ï¸",-1),e("span",{class:"action-label"},"BPJS",-1)])]),h.value?(r(),u("button",{key:0,onClick:a[10]||(a[10]=p=>b.value=!0),class:"action-btn admin-menu-btn"},[...a[40]||(a[40]=[e("span",{class:"action-icon"},"âš™ï¸",-1),e("span",{class:"action-label"},"Kelola Menu",-1)])])):C("",!0),h.value?(r(),u("button",{key:1,onClick:a[11]||(a[11]=p=>I.value=!0),class:"action-btn admin-menu-btn"},[...a[41]||(a[41]=[e("span",{class:"action-icon"},"ðŸ‘¥",-1),e("span",{class:"action-label"},"Kelola Role",-1)])])):C("",!0),h.value?(r(),u("button",{key:2,onClick:a[12]||(a[12]=p=>K()),class:"action-btn admin-menu-btn"},[...a[42]||(a[42]=[e("span",{class:"action-icon"},"ðŸ”",-1),e("span",{class:"action-label"},"Kelola Role-Menu",-1)])])):C("",!0),e("button",{onClick:a[13]||(a[13]=p=>F("laporan")),class:"action-btn"},[...a[43]||(a[43]=[e("span",{class:"action-icon"},"ðŸ“Š",-1),e("span",{class:"action-label"},"Laporan",-1)])])])]),e("div",Sl,[a[45]||(a[45]=e("h3",null,"Aktivitas Terkini",-1)),e("div",Al,[(r(!0),u(z,null,X(D.value,p=>(r(),u("div",{key:p.id,class:"activity-item"},[e("div",{class:P(["activity-icon",p.type])},i(L(p.type)),3),e("div",Pl,[e("p",Tl,i(p.description),1),e("span",Dl,i(p.time),1)])]))),128))])])]),a[46]||(a[46]=ve('<section class="system-status" data-v-4adf8f07><h3 data-v-4adf8f07>Status Sistem</h3><div class="status-grid" data-v-4adf8f07><div class="status-item" data-v-4adf8f07><span class="status-label" data-v-4adf8f07>Database</span><span class="status-indicator online" data-v-4adf8f07>Online</span></div><div class="status-item" data-v-4adf8f07><span class="status-label" data-v-4adf8f07>API Server</span><span class="status-indicator online" data-v-4adf8f07>Online</span></div><div class="status-item" data-v-4adf8f07><span class="status-label" data-v-4adf8f07>BPJS Integration</span><span class="status-indicator online" data-v-4adf8f07>Online</span></div><div class="status-item" data-v-4adf8f07><span class="status-label" data-v-4adf8f07>Backup System</span><span class="status-indicator warning" data-v-4adf8f07>Warning</span></div></div></section>',1))]),b.value?(r(),re(Os,{key:0,onClose:a[14]||(a[14]=p=>b.value=!1)})):C("",!0),I.value?(r(),re(Zt,{key:1,onClose:a[15]||(a[15]=p=>I.value=!1)})):C("",!0),$.value?(r(),re(al,{key:2,onClose:a[16]||(a[16]=p=>$.value=!1)})):C("",!0)]))}},jl=ne(Vl,[["__scopeId","data-v-4adf8f07"]]);export{jl as default};
