const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pegawaiService-B330j5v3.js","assets/index-CXPIpl-L.js","assets/vendor-abe1rO6K.js","assets/api-B9ygI19o.js","assets/index-BaygGJt-.css"])))=>i.map(i=>d[i]);
import{r as p,y as na,c as L,o as la,a as m,i as c,b as a,e as Y,A as k,B as P,D as _,F as aa,f as ea,t as u,z as E,j as A,n as Z,G as Q,m as va,p as ga}from"./vendor-abe1rO6K.js";import{d as y,_ as ta,f as ra}from"./index-CXPIpl-L.js";import{a as da}from"./asetInventarisService-8MSbNnQZ.js";import{pegawaiService as ka}from"./pegawaiService-B330j5v3.js";import{S as K}from"./SearchableSelect-Lnl9dbY0.js";import"./api-B9ygI19o.js";const $={getPermintaanPerbaikan(r){return y.get("/aset/permintaan-perbaikan",{params:r})},createPermintaanPerbaikan(r){return y.post("/aset/permintaan-perbaikan",r)},showPermintaanPerbaikan(r){return y.get(`/aset/permintaan-perbaikan/${r}`)},updatePermintaanPerbaikan(r,b){return y.put(`/aset/permintaan-perbaikan/${r}`,b)},deletePermintaanPerbaikan(r){return y.delete(`/aset/permintaan-perbaikan/${r}`)},getPerbaikanInventaris(r){return y.get("/aset/perbaikan-inventaris",{params:r})},createPerbaikanInventaris(r){return y.post("/aset/perbaikan-inventaris",r)},showPerbaikanInventaris(r){return y.get(`/aset/perbaikan-inventaris/${r}`)},updatePerbaikanInventaris(r,b){return y.put(`/aset/perbaikan-inventaris/${r}`,b)},deletePerbaikanInventaris(r){return y.delete(`/aset/perbaikan-inventaris/${r}`)},getPemeliharaanInventaris(r){return y.get("/aset/pemeliharaan-inventaris",{params:r})},createPemeliharaanInventaris(r){return y.post("/aset/pemeliharaan-inventaris",r)},updatePemeliharaanInventaris(r){return y.put("/aset/pemeliharaan-inventaris/update",r)},deletePemeliharaanInventaris(r){return y.delete("/aset/pemeliharaan-inventaris",{data:r})},getPemeliharaanGedung(r){return y.get("/aset/pemeliharaan-gedung",{params:r})},createPemeliharaanGedung(r){return y.post("/aset/pemeliharaan-gedung",r)},showPemeliharaanGedung(r){return y.get(`/aset/pemeliharaan-gedung/${r}`)},updatePemeliharaanGedung(r,b){return y.put(`/aset/pemeliharaan-gedung/${r}`,b)},deletePemeliharaanGedung(r){return y.delete(`/aset/pemeliharaan-gedung/${r}`)}},ba={class:"tab-container"},_a={class:"header-action"},fa={class:"search-box"},ha={class:"table-responsive"},ya={class:"data-table"},Pa={key:0},$a={key:1},Ia={class:"font-mono"},xa={class:"font-medium"},wa={class:"text-xs text-slate-500 font-mono"},Sa={class:"font-medium"},Ta={class:"text-xs text-slate-500"},Va={class:"max-w-xs"},Da={key:0,class:"status-badge bg-green-100 text-green-700"},Ca={key:1,class:"status-badge bg-orange-100 text-orange-700"},Ma={class:"action-group"},ja=["onClick"],Ua=["onClick"],Ga={class:"modal-content"},Ra={class:"modal-header"},Ba={class:"modal-body"},Na={class:"form-group"},Oa=["disabled"],qa={class:"form-group"},Ea={class:"form-group"},Fa={class:"form-group"},Aa={class:"form-group"},Ka={class:"modal-footer"},La=["disabled"],Ja={__name:"TiketPerbaikanTab",setup(r){const b=p([]),x=p(!1),S=p(""),I=p(!1),f=p(!1),h=p(!1),o=na({no_permintaan:"",no_inventaris:"",nik:"",tanggal:"",deskripsi_kerusakan:""}),v=p([]),B=p([]),M=L(()=>v.value.map(n=>{var t;return{...n,label:`${n.no_inventaris} - ${((t=n.barang)==null?void 0:t.nama_barang)||""}`}})),N=L(()=>B.value.map(n=>({...n,nik:n.nik||n.id_user,label:`${n.nik||n.id_user||"-"} - ${n.nama}`}))),D=async()=>{x.value=!0;try{const n=await $.getPermintaanPerbaikan({search:S.value,limit:100});n.data.data&&(b.value=n.data.data.data)}catch(n){console.error(n)}finally{x.value=!1}},w=async()=>{try{const[n,t]=await Promise.all([da.getInventaris({limit:1e3}),ka.getPegawai(1,1e3)]);if(n.data.data){const d=n.data.data.data||n.data.data||[];v.value=d}t.data.data&&(B.value=t.data.data||[])}catch(n){console.error("Gagal fetch options",n)}},O=()=>{f.value=!1,H(),w(),I.value=!0},g=()=>{I.value=!1},J=n=>{f.value=!0,Object.assign(o,{no_permintaan:n.no_permintaan,no_inventaris:n.no_inventaris,nik:n.nik,tanggal:n.tanggal?n.tanggal.replace(" ","T").substring(0,16):"",deskripsi_kerusakan:n.deskripsi_kerusakan}),w(),I.value=!0},H=async()=>{const n=new Date,t=n.getFullYear(),d=String(n.getMonth()+1).padStart(2,"0"),U=String(n.getDate()).padStart(2,"0"),V=`PPI${`${t}${d}${U}`}`;let q=1;try{const j=await $.getPermintaanPerbaikan({limit:1,sort_by:"no_permintaan",order:"desc",search:V});if(j.data.data){const C=j.data.data.data||j.data.data||[];if(C.length>0){const F=C[0];if(F.no_permintaan&&F.no_permintaan.startsWith(V)){const W=F.no_permintaan.substring(V.length);q=parseInt(W,10)+1}}}}catch(j){console.error("Gagal generate no permintaan",j)}const G=`${V}${String(q).padStart(3,"0")}`;Object.assign(o,{no_permintaan:G,no_inventaris:"",nik:"",tanggal:n.toISOString().substring(0,16),deskripsi_kerusakan:""})},z=async()=>{var n,t;h.value=!0;try{f.value?await $.updatePermintaanPerbaikan(o.no_permintaan,o):await $.createPermintaanPerbaikan(o),g(),D()}catch(d){alert("Gagal simpan data: "+(((t=(n=d.response)==null?void 0:n.data)==null?void 0:t.message)||d.message))}finally{h.value=!1}},X=async n=>{if(confirm("Hapus tiket perbaikan ini?"))try{await $.deletePermintaanPerbaikan(n),D()}catch{alert("Gagal hapus")}},i=n=>n?new Date(n).toLocaleDateString("id-ID"):"-";return la(()=>D()),(n,t)=>(c(),m("div",ba,[a("div",_a,[a("div",fa,[k(a("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>S.value=d),onInput:D,type:"text",placeholder:"Cari No Permintaan / Deskripsi...",class:"form-input"},null,544),[[P,S.value]])]),a("button",{onClick:O,class:"btn-add"},[...t[6]||(t[6]=[a("i",{class:"fas fa-plus"},null,-1),_(" Buat Tiket Perbaikan ",-1)])])]),a("div",ha,[a("table",ya,[t[11]||(t[11]=a("thead",null,[a("tr",null,[a("th",null,"No Permintaan"),a("th",null,"Tanggal"),a("th",null,"Inventaris"),a("th",null,"Pelapor"),a("th",null,"Deskripsi Kerusakan"),a("th",null,"Status"),a("th",{width:"100"},"Aksi")])],-1)),a("tbody",null,[x.value?(c(),m("tr",Pa,[...t[7]||(t[7]=[a("td",{colspan:"7",class:"text-center"},"Memuat...",-1)])])):b.value.length===0?(c(),m("tr",$a,[...t[8]||(t[8]=[a("td",{colspan:"7",class:"text-center"},"Data kosong",-1)])])):(c(!0),m(aa,{key:2},ea(b.value,d=>{var U,T,V;return c(),m("tr",{key:d.no_permintaan},[a("td",Ia,u(d.no_permintaan),1),a("td",null,u(i(d.tanggal)),1),a("td",null,[a("div",xa,u(((T=(U=d.inventaris)==null?void 0:U.barang)==null?void 0:T.nama_barang)||"-"),1),a("div",wa,u(d.no_inventaris),1)]),a("td",null,[a("div",Sa,u(((V=d.pegawai)==null?void 0:V.nama)||"-"),1),a("div",Ta,u(d.nik),1)]),a("td",Va,u(d.deskripsi_kerusakan),1),a("td",null,[d.perbaikan_inventaris?(c(),m("span",Da," Sudah Diperbaiki ")):(c(),m("span",Ca," Menunggu Perbaikan "))]),a("td",null,[a("div",Ma,[a("button",{onClick:q=>J(d),class:"btn-icon text-blue"},[...t[9]||(t[9]=[a("i",{class:"fas fa-edit"},null,-1)])],8,ja),a("button",{onClick:q=>X(d.no_permintaan),class:"btn-icon text-red"},[...t[10]||(t[10]=[a("i",{class:"fas fa-trash"},null,-1)])],8,Ua)])])])}),128))])])]),I.value?(c(),m("div",{key:0,class:"modal-overlay",onClick:E(g,["self"])},[a("div",Ga,[a("div",Ra,[a("h3",null,u(f.value?"Edit":"Buat")+" Tiket Perbaikan",1),a("button",{onClick:g,class:"close-btn"},"×")]),a("form",{onSubmit:E(z,["prevent"])},[a("div",Ba,[a("div",Na,[t[12]||(t[12]=a("label",null,[_("No Permintaan "),a("span",{class:"text-red"},"*")],-1)),k(a("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>o.no_permintaan=d),type:"text",class:"form-input",disabled:f.value,required:"",placeholder:"Auto-generate jika kosong"},null,8,Oa),[[P,o.no_permintaan]])]),a("div",qa,[t[13]||(t[13]=a("label",null,"Item Inventaris",-1)),A(K,{modelValue:o.no_inventaris,"onUpdate:modelValue":t[2]||(t[2]=d=>o.no_inventaris=d),options:M.value,"label-key":"label","value-key":"no_inventaris",placeholder:"Pilih Item Inventaris"},null,8,["modelValue","options"])]),a("div",Ea,[t[14]||(t[14]=a("label",null,"Pelapor (NIK)",-1)),A(K,{modelValue:o.nik,"onUpdate:modelValue":t[3]||(t[3]=d=>o.nik=d),options:N.value,"label-key":"label","value-key":"nik",placeholder:"Pilih Pegawai"},null,8,["modelValue","options"])]),a("div",Fa,[t[15]||(t[15]=a("label",null,"Tanggal",-1)),k(a("input",{"onUpdate:modelValue":t[4]||(t[4]=d=>o.tanggal=d),type:"datetime-local",class:"form-input"},null,512),[[P,o.tanggal]])]),a("div",Aa,[t[16]||(t[16]=a("label",null,"Deskripsi Kerusakan",-1)),k(a("textarea",{"onUpdate:modelValue":t[5]||(t[5]=d=>o.deskripsi_kerusakan=d),class:"form-textarea",rows:"4",placeholder:"Jelaskan kerusakan yang terjadi..."},null,512),[[P,o.deskripsi_kerusakan]])])]),a("div",Ka,[a("button",{type:"button",onClick:g,class:"btn-cancel"},"Batal"),a("button",{type:"submit",class:"btn-save",disabled:h.value},u(h.value?"Menyimpan...":"Simpan"),9,La)])],32)])])):Y("",!0)]))}},Ha=ta(Ja,[["__scopeId","data-v-a1c91e72"]]),za={class:"tab-container"},Wa={class:"section-tabs"},Ya={key:0,class:"section-content"},Qa={class:"header-action"},Xa={class:"search-box"},Za={class:"table-responsive"},ae={class:"data-table"},ee={key:0},ne={key:1},te={class:"font-mono"},se={class:"text-sm"},le={class:"text-xs text-slate-500"},ie={class:"action-group"},oe=["onClick"],re=["onClick"],de={key:1,class:"section-content"},ue={class:"header-action"},pe={class:"search-box"},ce={class:"table-responsive"},me={class:"data-table"},ve={key:0},ge={key:1},ke={class:"font-mono"},be={class:"badge-jenis"},_e={class:"text-sm"},fe={class:"text-xs text-slate-500"},he={class:"action-group"},ye=["onClick"],Pe=["onClick"],$e={class:"modal-content"},Ie={class:"modal-header"},xe={class:"modal-body"},we={class:"form-group"},Se={class:"form-row"},Te={class:"form-group"},Ve={class:"form-group"},De={class:"form-group"},Ce={class:"form-row"},Me={class:"form-group"},je={class:"form-group"},Ue={class:"form-row"},Ge={class:"form-group"},Re={class:"form-group"},Be={class:"modal-footer"},Ne=["disabled"],Oe={class:"modal-content"},qe={class:"modal-header"},Ee={class:"modal-body"},Fe={class:"form-row"},Ae={class:"form-group"},Ke={class:"form-group"},Le=["disabled"],Je={class:"form-group"},He={class:"form-row"},ze={class:"form-group"},We={class:"form-group"},Ye={class:"form-row"},Qe={class:"form-group"},Xe={class:"form-group"},Ze={class:"modal-footer"},an=["disabled"],en={__name:"PerbaikanServisTab",setup(r){const b=p("perbaikan"),x=p([]),S=p(!1),I=p(""),f=p(!1),h=p(!1),o=p(!1),v=na({no_permintaan:"",tanggal:"",uraian_kegiatan:"",nip:"",pelaksana:"Teknisi Rumah Sakit",biaya:0,keterangan:"",status:"Bisa Diperbaiki"}),B=p([]),M=p(!1),N=p(""),D=p(!1),w=p(!1),O=p(!1),g=na({no_inventaris:"",tanggal:"",uraian_kegiatan:"",nip:"",pelaksana:"Teknisi Rumah Sakit",biaya:0,jenis_pemeliharaan:"Running Maintenance"}),J=p([]),H=p([]),z=p([]),X=L(()=>H.value.map(l=>{var e;return{...l,label:`${l.no_inventaris} - ${((e=l.barang)==null?void 0:e.nama_barang)||""}`}})),i=L(()=>z.value.map(l=>({...l,label:`${l.nip} - ${l.nama}`}))),n=L(()=>J.value.map(l=>{var e,s;return{...l,label:`${l.no_permintaan} - ${((s=(e=l.inventaris)==null?void 0:e.barang)==null?void 0:s.nama_barang)||"Barang tidak diketahui"}`}})),t=async()=>{S.value=!0;try{const l=await $.getPerbaikanInventaris({search:I.value,limit:100});l.data.data&&(x.value=l.data.data.data||l.data.data||[])}catch(l){console.error(l)}finally{S.value=!1}},d=async()=>{try{const[l,e,s]=await Promise.all([$.getPermintaanPerbaikan({limit:1e3}),da.getInventaris({limit:1e3}),ra(()=>import("./pegawaiService-B330j5v3.js"),__vite__mapDeps([0,1,2,3,4])).then(R=>R.pegawaiService.getPegawai(1,1e3))]);if(l.data.data&&(J.value=l.data.data.data||[]),e.data.data){const R=e.data.data.data||e.data.data||[];H.value=R}s.data.data&&(z.value=s.data.data||[])}catch(l){console.error("Gagal fetch options",l)}},U=()=>{h.value=!1,q(),d(),f.value=!0},T=()=>{f.value=!1},V=l=>{h.value=!0,Object.assign(v,{no_permintaan:l.no_permintaan,tanggal:l.tanggal,uraian_kegiatan:l.uraian_kegiatan,nip:l.nip,pelaksana:l.pelaksana,biaya:l.biaya,keterangan:l.keterangan,status:l.status}),d(),f.value=!0},q=()=>{Object.assign(v,{no_permintaan:"",tanggal:new Date().toISOString().split("T")[0],uraian_kegiatan:"",nip:"",pelaksana:"Teknisi Rumah Sakit",biaya:0,keterangan:"",status:"Bisa Diperbaiki"})},G=async()=>{var l,e;o.value=!0;try{h.value?await $.updatePerbaikanInventaris(v.no_permintaan,v):await $.createPerbaikanInventaris(v),T(),t()}catch(s){alert("Gagal simpan: "+(((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.message)||s.message))}finally{o.value=!1}},j=async l=>{if(confirm("Hapus data perbaikan ini?"))try{await $.deletePerbaikanInventaris(l),t()}catch{alert("Gagal hapus")}},C=async()=>{M.value=!0;try{const l=await $.getPemeliharaanInventaris({search:N.value,limit:100});l.data.data&&(B.value=l.data.data.data)}catch(l){console.error(l)}finally{M.value=!1}},F=()=>{w.value=!1,pa(),d(),D.value=!0},W=()=>{D.value=!1},ua=l=>{w.value=!0,Object.assign(g,{no_inventaris:l.no_inventaris,tanggal:l.tanggal,uraian_kegiatan:l.uraian_kegiatan,nip:l.nip,pelaksana:l.pelaksana,biaya:l.biaya,jenis_pemeliharaan:l.jenis_pemeliharaan}),d(),D.value=!0},pa=()=>{Object.assign(g,{no_inventaris:"",tanggal:new Date().toISOString().split("T")[0],uraian_kegiatan:"",nip:"",pelaksana:"Teknisi Rumah Sakit",biaya:0,jenis_pemeliharaan:"Running Maintenance"})},ca=async()=>{var l,e;O.value=!0;try{w.value?await $.updatePemeliharaanInventaris(g):await $.createPemeliharaanInventaris(g),W(),C()}catch(s){alert("Gagal simpan: "+(((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.message)||s.message))}finally{O.value=!1}},ma=async l=>{if(confirm("Hapus data pemeliharaan ini?"))try{await $.deletePemeliharaanInventaris({no_inventaris:l.no_inventaris,tanggal:l.tanggal}),C()}catch{alert("Gagal hapus")}},ia=l=>l?new Date(l).toLocaleDateString("id-ID"):"-",oa=l=>l?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(l):"Rp 0";return la(()=>{t(),C()}),(l,e)=>(c(),m("div",za,[a("div",Wa,[a("button",{onClick:e[0]||(e[0]=s=>b.value="perbaikan"),class:Z(["section-tab",{active:b.value==="perbaikan"}])}," Perbaikan Inventaris ",2),a("button",{onClick:e[1]||(e[1]=s=>b.value="pemeliharaan"),class:Z(["section-tab",{active:b.value==="pemeliharaan"}])}," Pemeliharaan Inventaris ",2)]),b.value==="perbaikan"?(c(),m("div",Ya,[a("div",Qa,[a("div",Xa,[k(a("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>I.value=s),onInput:t,type:"text",placeholder:"Cari No Permintaan / Uraian...",class:"form-input"},null,544),[[P,I.value]])]),a("button",{onClick:U,class:"btn-add"},[...e[19]||(e[19]=[a("i",{class:"fas fa-plus"},null,-1),_(" Tambah Perbaikan ",-1)])])]),a("div",Za,[a("table",ae,[e[24]||(e[24]=a("thead",null,[a("tr",null,[a("th",null,"No Permintaan"),a("th",null,"Tanggal"),a("th",null,"Uraian Kegiatan"),a("th",null,"Pelaksana"),a("th",null,"Biaya"),a("th",null,"Status"),a("th",{width:"100"},"Aksi")])],-1)),a("tbody",null,[S.value?(c(),m("tr",ee,[...e[20]||(e[20]=[a("td",{colspan:"7",class:"text-center"},"Memuat...",-1)])])):x.value.length===0?(c(),m("tr",ne,[...e[21]||(e[21]=[a("td",{colspan:"7",class:"text-center"},"Data kosong",-1)])])):(c(!0),m(aa,{key:2},ea(x.value,s=>{var R;return c(),m("tr",{key:s.no_permintaan},[a("td",te,u(s.no_permintaan),1),a("td",null,u(ia(s.tanggal)),1),a("td",null,u(s.uraian_kegiatan),1),a("td",null,[a("div",se,u(s.pelaksana),1),a("div",le,u(((R=s.petugas)==null?void 0:R.nama)||"-"),1)]),a("td",null,u(oa(s.biaya)),1),a("td",null,[a("span",{class:Z(["status-badge",s.status==="Bisa Diperbaiki"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},u(s.status),3)]),a("td",null,[a("div",ie,[a("button",{onClick:sa=>V(s),class:"btn-icon text-blue"},[...e[22]||(e[22]=[a("i",{class:"fas fa-edit"},null,-1)])],8,oe),a("button",{onClick:sa=>j(s.no_permintaan),class:"btn-icon text-red"},[...e[23]||(e[23]=[a("i",{class:"fas fa-trash"},null,-1)])],8,re)])])])}),128))])])])])):Y("",!0),b.value==="pemeliharaan"?(c(),m("div",de,[a("div",ue,[a("div",pe,[k(a("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>N.value=s),onInput:C,type:"text",placeholder:"Cari No Inventaris / Uraian...",class:"form-input"},null,544),[[P,N.value]])]),a("button",{onClick:F,class:"btn-add"},[...e[25]||(e[25]=[a("i",{class:"fas fa-plus"},null,-1),_(" Tambah Pemeliharaan ",-1)])])]),a("div",ce,[a("table",me,[e[30]||(e[30]=a("thead",null,[a("tr",null,[a("th",null,"No Inventaris"),a("th",null,"Tanggal"),a("th",null,"Uraian Kegiatan"),a("th",null,"Jenis Pemeliharaan"),a("th",null,"Pelaksana"),a("th",null,"Biaya"),a("th",{width:"100"},"Aksi")])],-1)),a("tbody",null,[M.value?(c(),m("tr",ve,[...e[26]||(e[26]=[a("td",{colspan:"7",class:"text-center"},"Memuat...",-1)])])):B.value.length===0?(c(),m("tr",ge,[...e[27]||(e[27]=[a("td",{colspan:"7",class:"text-center"},"Data kosong",-1)])])):(c(!0),m(aa,{key:2},ea(B.value,s=>{var R;return c(),m("tr",{key:`${s.no_inventaris}-${s.tanggal}`},[a("td",ke,u(s.no_inventaris),1),a("td",null,u(ia(s.tanggal)),1),a("td",null,u(s.uraian_kegiatan),1),a("td",null,[a("span",be,u(s.jenis_pemeliharaan),1)]),a("td",null,[a("div",_e,u(s.pelaksana),1),a("div",fe,u(((R=s.petugas)==null?void 0:R.nama)||"-"),1)]),a("td",null,u(oa(s.biaya)),1),a("td",null,[a("div",he,[a("button",{onClick:sa=>ua(s),class:"btn-icon text-blue"},[...e[28]||(e[28]=[a("i",{class:"fas fa-edit"},null,-1)])],8,ye),a("button",{onClick:sa=>ma(s),class:"btn-icon text-red"},[...e[29]||(e[29]=[a("i",{class:"fas fa-trash"},null,-1)])],8,Pe)])])])}),128))])])])])):Y("",!0),f.value?(c(),m("div",{key:2,class:"modal-overlay",onClick:E(T,["self"])},[a("div",$e,[a("div",Ie,[a("h3",null,u(h.value?"Edit":"Tambah")+" Perbaikan Inventaris",1),a("button",{onClick:T,class:"close-btn"},"×")]),a("form",{onSubmit:E(G,["prevent"])},[a("div",xe,[a("div",we,[e[31]||(e[31]=a("label",null,[_("No Permintaan "),a("span",{class:"text-red"},"*")],-1)),A(K,{modelValue:v.no_permintaan,"onUpdate:modelValue":e[4]||(e[4]=s=>v.no_permintaan=s),options:n.value,"label-key":"label","value-key":"no_permintaan",placeholder:"Pilih Permintaan Perbaikan",disabled:h.value},null,8,["modelValue","options","disabled"])]),a("div",Se,[a("div",Te,[e[32]||(e[32]=a("label",null,[_("Tanggal "),a("span",{class:"text-red"},"*")],-1)),k(a("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>v.tanggal=s),type:"date",class:"form-input",required:""},null,512),[[P,v.tanggal]])]),a("div",Ve,[e[33]||(e[33]=a("label",null,"Biaya",-1)),k(a("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>v.biaya=s),type:"number",class:"form-input",min:"0"},null,512),[[P,v.biaya,void 0,{number:!0}]])])]),a("div",De,[e[34]||(e[34]=a("label",null,[_("Uraian Kegiatan "),a("span",{class:"text-red"},"*")],-1)),k(a("textarea",{"onUpdate:modelValue":e[7]||(e[7]=s=>v.uraian_kegiatan=s),class:"form-textarea",rows:"3",required:""},null,512),[[P,v.uraian_kegiatan]])]),a("div",Ce,[a("div",Me,[e[36]||(e[36]=a("label",null,[_("Pelaksana "),a("span",{class:"text-red"},"*")],-1)),k(a("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>v.pelaksana=s),class:"form-select",required:""},[...e[35]||(e[35]=[a("option",{value:"Teknisi Rumah Sakit"},"Teknisi Rumah Sakit",-1),a("option",{value:"Teknisi Rujukan"},"Teknisi Rujukan",-1),a("option",{value:"Pihak ke III"},"Pihak ke III",-1)])],512),[[Q,v.pelaksana]])]),a("div",je,[e[37]||(e[37]=a("label",null,"Petugas (NIP)",-1)),A(K,{modelValue:v.nip,"onUpdate:modelValue":e[9]||(e[9]=s=>v.nip=s),options:i.value,"label-key":"label","value-key":"nip",placeholder:"Pilih Petugas"},null,8,["modelValue","options"])])]),a("div",Ue,[a("div",Ge,[e[39]||(e[39]=a("label",null,[_("Status "),a("span",{class:"text-red"},"*")],-1)),k(a("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>v.status=s),class:"form-select",required:""},[...e[38]||(e[38]=[a("option",{value:"Bisa Diperbaiki"},"Bisa Diperbaiki",-1),a("option",{value:"Tidak Bisa Diperbaiki"},"Tidak Bisa Diperbaiki",-1)])],512),[[Q,v.status]])]),a("div",Re,[e[40]||(e[40]=a("label",null,"Keterangan",-1)),k(a("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>v.keterangan=s),type:"text",class:"form-input"},null,512),[[P,v.keterangan]])])])]),a("div",Be,[a("button",{type:"button",onClick:T,class:"btn-cancel"},"Batal"),a("button",{type:"submit",class:"btn-save",disabled:o.value},u(o.value?"Menyimpan...":"Simpan"),9,Ne)])],32)])])):Y("",!0),D.value?(c(),m("div",{key:3,class:"modal-overlay",onClick:E(W,["self"])},[a("div",Oe,[a("div",qe,[a("h3",null,u(w.value?"Edit":"Tambah")+" Pemeliharaan Inventaris",1),a("button",{onClick:W,class:"close-btn"},"×")]),a("form",{onSubmit:E(ca,["prevent"])},[a("div",Ee,[a("div",Fe,[a("div",Ae,[e[41]||(e[41]=a("label",null,[_("No Inventaris "),a("span",{class:"text-red"},"*")],-1)),A(K,{modelValue:g.no_inventaris,"onUpdate:modelValue":e[12]||(e[12]=s=>g.no_inventaris=s),options:X.value,"label-key":"label","value-key":"no_inventaris",placeholder:"Pilih Inventaris",disabled:w.value},null,8,["modelValue","options","disabled"])]),a("div",Ke,[e[42]||(e[42]=a("label",null,[_("Tanggal "),a("span",{class:"text-red"},"*")],-1)),k(a("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>g.tanggal=s),type:"date",class:"form-input",required:"",disabled:w.value},null,8,Le),[[P,g.tanggal]])])]),a("div",Je,[e[43]||(e[43]=a("label",null,[_("Uraian Kegiatan "),a("span",{class:"text-red"},"*")],-1)),k(a("textarea",{"onUpdate:modelValue":e[14]||(e[14]=s=>g.uraian_kegiatan=s),class:"form-textarea",rows:"3",required:""},null,512),[[P,g.uraian_kegiatan]])]),a("div",He,[a("div",ze,[e[45]||(e[45]=a("label",null,[_("Jenis Pemeliharaan "),a("span",{class:"text-red"},"*")],-1)),k(a("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>g.jenis_pemeliharaan=s),class:"form-select",required:""},[...e[44]||(e[44]=[a("option",{value:"Running Maintenance"},"Running Maintenance",-1),a("option",{value:"Shut Down Maintenance"},"Shut Down Maintenance",-1),a("option",{value:"Emergency Maintenance"},"Emergency Maintenance",-1)])],512),[[Q,g.jenis_pemeliharaan]])]),a("div",We,[e[46]||(e[46]=a("label",null,"Biaya",-1)),k(a("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>g.biaya=s),type:"number",class:"form-input",min:"0"},null,512),[[P,g.biaya,void 0,{number:!0}]])])]),a("div",Ye,[a("div",Qe,[e[48]||(e[48]=a("label",null,[_("Pelaksana "),a("span",{class:"text-red"},"*")],-1)),k(a("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>g.pelaksana=s),class:"form-select",required:""},[...e[47]||(e[47]=[a("option",{value:"Teknisi Rumah Sakit"},"Teknisi Rumah Sakit",-1),a("option",{value:"Teknisi Rujukan"},"Teknisi Rujukan",-1),a("option",{value:"Pihak ke III"},"Pihak ke III",-1)])],512),[[Q,g.pelaksana]])]),a("div",Xe,[e[49]||(e[49]=a("label",null,"Petugas (NIP)",-1)),A(K,{modelValue:g.nip,"onUpdate:modelValue":e[18]||(e[18]=s=>g.nip=s),options:i.value,"label-key":"label","value-key":"nip",placeholder:"Pilih Petugas"},null,8,["modelValue","options"])])])]),a("div",Ze,[a("button",{type:"button",onClick:W,class:"btn-cancel"},"Batal"),a("button",{type:"submit",class:"btn-save",disabled:O.value},u(O.value?"Menyimpan...":"Simpan"),9,an)])],32)])])):Y("",!0)]))}},nn=ta(en,[["__scopeId","data-v-82e174dc"]]),tn={class:"tab-container"},sn={class:"header-action"},ln={class:"search-box"},on={class:"table-responsive"},rn={class:"data-table"},dn={key:0},un={key:1},pn={class:"font-mono"},cn={class:"badge-jenis"},mn={class:"text-sm"},vn={class:"text-xs text-slate-500"},gn={class:"max-w-xs"},kn={class:"action-group"},bn=["onClick"],_n=["onClick"],fn={class:"modal-content"},hn={class:"modal-header"},yn={class:"modal-body"},Pn={class:"form-group"},$n=["disabled"],In={class:"form-row"},xn={class:"form-group"},wn={class:"form-group"},Sn={class:"form-group"},Tn={class:"form-row"},Vn={class:"form-group"},Dn={class:"form-group"},Cn={class:"form-group"},Mn={class:"form-group"},jn={class:"modal-footer"},Un=["disabled"],Gn={__name:"FasilitasGedungTab",setup(r){const b=p([]),x=p(!1),S=p(""),I=p(!1),f=p(!1),h=p(!1),o=na({no_pemeliharaan:"",tanggal:"",uraian_kegiatan:"",nip:"",pelaksana:"Teknisi Rumah Sakit",biaya:0,jenis_pemeliharaan:"Running Maintenance",tindak_lanjut:""}),v=p([]),B=L(()=>v.value.map(i=>({...i,label:`${i.nip} - ${i.nama}`}))),M=async()=>{x.value=!0;try{const i=await $.getPemeliharaanGedung({search:S.value,limit:100});i.data.data&&(b.value=i.data.data.data)}catch(i){console.error(i)}finally{x.value=!1}},N=async()=>{try{const i=await ra(()=>import("./pegawaiService-B330j5v3.js"),__vite__mapDeps([0,1,2,3,4])).then(n=>n.pegawaiService.getPegawai(1,1e3));i.data.data&&(v.value=i.data.data||[])}catch(i){console.error("Gagal fetch options",i)}},D=()=>{f.value=!1,g(),N(),I.value=!0},w=()=>{I.value=!1},O=i=>{f.value=!0,Object.assign(o,{no_pemeliharaan:i.no_pemeliharaan,tanggal:i.tanggal,uraian_kegiatan:i.uraian_kegiatan,nip:i.nip,pelaksana:i.pelaksana,biaya:i.biaya,jenis_pemeliharaan:i.jenis_pemeliharaan,tindak_lanjut:i.tindak_lanjut}),N(),I.value=!0},g=async()=>{const i=new Date,n=i.getFullYear(),t=String(i.getMonth()+1).padStart(2,"0"),d=String(i.getDate()).padStart(2,"0"),T=`PG${`${n}${t}${d}`}`;let V=1;try{const G=await $.getPemeliharaanGedung({limit:1,sort_by:"no_pemeliharaan",order:"desc",search:T});if(G.data.data){const j=G.data.data.data||G.data.data||[];if(j.length>0){const C=j[0];if(C.no_pemeliharaan&&C.no_pemeliharaan.startsWith(T)){const F=C.no_pemeliharaan.substring(T.length);V=parseInt(F,10)+1}}}}catch(G){console.error("Gagal generate no pemeliharaan",G)}const q=`${T}${String(V).padStart(3,"0")}`;Object.assign(o,{no_pemeliharaan:q,tanggal:i.toISOString().split("T")[0],uraian_kegiatan:"",nip:"",pelaksana:"Teknisi Rumah Sakit",biaya:0,jenis_pemeliharaan:"Running Maintenance",tindak_lanjut:""})},J=async()=>{var i,n;h.value=!0;try{f.value?await $.updatePemeliharaanGedung(o.no_pemeliharaan,o):await $.createPemeliharaanGedung(o),w(),M()}catch(t){alert("Gagal simpan data: "+(((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||t.message))}finally{h.value=!1}},H=async i=>{if(confirm("Hapus data pemeliharaan gedung ini?"))try{await $.deletePemeliharaanGedung(i),M()}catch{alert("Gagal hapus")}},z=i=>i?new Date(i).toLocaleDateString("id-ID"):"-",X=i=>i?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(i):"Rp 0";return la(()=>M()),(i,n)=>(c(),m("div",tn,[a("div",sn,[a("div",ln,[k(a("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>S.value=t),onInput:M,type:"text",placeholder:"Cari No Pemeliharaan / Uraian...",class:"form-input"},null,544),[[P,S.value]])]),a("button",{onClick:D,class:"btn-add"},[...n[9]||(n[9]=[a("i",{class:"fas fa-plus"},null,-1),_(" Tambah Pemeliharaan Gedung ",-1)])])]),a("div",on,[a("table",rn,[n[14]||(n[14]=a("thead",null,[a("tr",null,[a("th",null,"No Pemeliharaan"),a("th",null,"Tanggal"),a("th",null,"Uraian Kegiatan"),a("th",null,"Jenis Pemeliharaan"),a("th",null,"Pelaksana"),a("th",null,"Biaya"),a("th",null,"Tindak Lanjut"),a("th",{width:"100"},"Aksi")])],-1)),a("tbody",null,[x.value?(c(),m("tr",dn,[...n[10]||(n[10]=[a("td",{colspan:"8",class:"text-center"},"Memuat...",-1)])])):b.value.length===0?(c(),m("tr",un,[...n[11]||(n[11]=[a("td",{colspan:"8",class:"text-center"},"Data kosong",-1)])])):(c(!0),m(aa,{key:2},ea(b.value,t=>{var d;return c(),m("tr",{key:t.no_pemeliharaan},[a("td",pn,u(t.no_pemeliharaan),1),a("td",null,u(z(t.tanggal)),1),a("td",null,u(t.uraian_kegiatan),1),a("td",null,[a("span",cn,u(t.jenis_pemeliharaan),1)]),a("td",null,[a("div",mn,u(t.pelaksana),1),a("div",vn,u(((d=t.petugas)==null?void 0:d.nama)||"-"),1)]),a("td",null,u(X(t.biaya)),1),a("td",gn,u(t.tindak_lanjut),1),a("td",null,[a("div",kn,[a("button",{onClick:U=>O(t),class:"btn-icon text-blue"},[...n[12]||(n[12]=[a("i",{class:"fas fa-edit"},null,-1)])],8,bn),a("button",{onClick:U=>H(t.no_pemeliharaan),class:"btn-icon text-red"},[...n[13]||(n[13]=[a("i",{class:"fas fa-trash"},null,-1)])],8,_n)])])])}),128))])])]),I.value?(c(),m("div",{key:0,class:"modal-overlay",onClick:E(w,["self"])},[a("div",fn,[a("div",hn,[a("h3",null,u(f.value?"Edit":"Tambah")+" Pemeliharaan Gedung",1),a("button",{onClick:w,class:"close-btn"},"×")]),a("form",{onSubmit:E(J,["prevent"])},[a("div",yn,[a("div",Pn,[n[15]||(n[15]=a("label",null,[_("No Pemeliharaan "),a("span",{class:"text-red"},"*")],-1)),k(a("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>o.no_pemeliharaan=t),type:"text",class:"form-input",disabled:f.value,required:"",placeholder:"Auto-generate jika kosong"},null,8,$n),[[P,o.no_pemeliharaan]])]),a("div",In,[a("div",xn,[n[16]||(n[16]=a("label",null,[_("Tanggal "),a("span",{class:"text-red"},"*")],-1)),k(a("input",{"onUpdate:modelValue":n[2]||(n[2]=t=>o.tanggal=t),type:"date",class:"form-input",required:""},null,512),[[P,o.tanggal]])]),a("div",wn,[n[17]||(n[17]=a("label",null,"Biaya",-1)),k(a("input",{"onUpdate:modelValue":n[3]||(n[3]=t=>o.biaya=t),type:"number",class:"form-input",min:"0"},null,512),[[P,o.biaya,void 0,{number:!0}]])])]),a("div",Sn,[n[18]||(n[18]=a("label",null,[_("Uraian Kegiatan "),a("span",{class:"text-red"},"*")],-1)),k(a("textarea",{"onUpdate:modelValue":n[4]||(n[4]=t=>o.uraian_kegiatan=t),class:"form-textarea",rows:"3",required:""},null,512),[[P,o.uraian_kegiatan]])]),a("div",Tn,[a("div",Vn,[n[20]||(n[20]=a("label",null,[_("Jenis Pemeliharaan "),a("span",{class:"text-red"},"*")],-1)),k(a("select",{"onUpdate:modelValue":n[5]||(n[5]=t=>o.jenis_pemeliharaan=t),class:"form-select",required:""},[...n[19]||(n[19]=[a("option",{value:"Running Maintenance"},"Running Maintenance",-1),a("option",{value:"Shut Down Maintenance"},"Shut Down Maintenance",-1),a("option",{value:"Emergency Maintenance"},"Emergency Maintenance",-1)])],512),[[Q,o.jenis_pemeliharaan]])]),a("div",Dn,[n[22]||(n[22]=a("label",null,[_("Pelaksana "),a("span",{class:"text-red"},"*")],-1)),k(a("select",{"onUpdate:modelValue":n[6]||(n[6]=t=>o.pelaksana=t),class:"form-select",required:""},[...n[21]||(n[21]=[a("option",{value:"Teknisi Rumah Sakit"},"Teknisi Rumah Sakit",-1),a("option",{value:"Pihak ke III"},"Pihak ke III",-1)])],512),[[Q,o.pelaksana]])])]),a("div",Cn,[n[23]||(n[23]=a("label",null,"Petugas (NIP)",-1)),A(K,{modelValue:o.nip,"onUpdate:modelValue":n[7]||(n[7]=t=>o.nip=t),options:B.value,"label-key":"label","value-key":"nip",placeholder:"Pilih Petugas"},null,8,["modelValue","options"])]),a("div",Mn,[n[24]||(n[24]=a("label",null,[_("Tindak Lanjut "),a("span",{class:"text-red"},"*")],-1)),k(a("input",{"onUpdate:modelValue":n[8]||(n[8]=t=>o.tindak_lanjut=t),type:"text",class:"form-input",required:""},null,512),[[P,o.tindak_lanjut]])])]),a("div",jn,[a("button",{type:"button",onClick:w,class:"btn-cancel"},"Batal"),a("button",{type:"submit",class:"btn-save",disabled:h.value},u(h.value?"Menyimpan...":"Simpan"),9,Un)])],32)])])):Y("",!0)]))}},Rn=ta(Gn,[["__scopeId","data-v-bc44b04f"]]),Bn={class:"pemeliharaan-container"},Nn={class:"tabs-container"},On={class:"tabs-header"},qn=["onClick"],En={class:"tab-content"},Fn={__name:"PemeliharaanView",setup(r){const b=p("tiket"),x=[{id:"tiket",label:"Tiket Perbaikan",icon:"fas fa-ticket-alt",component:Ha},{id:"servis",label:"Perbaikan & Servis",icon:"fas fa-tools",component:nn},{id:"gedung",label:"Fasilitas Gedung",icon:"fas fa-building",component:Rn}],S=L(()=>{var I;return(I=x.find(f=>f.id===b.value))==null?void 0:I.component});return(I,f)=>(c(),m("div",Bn,[f[0]||(f[0]=a("div",{class:"page-header"},[a("h2",null,"Pemeliharaan Aset & Fasilitas"),a("p",{class:"subtitle"},"Manajemen perbaikan dan pemeliharaan inventaris serta gedung")],-1)),a("div",Nn,[a("div",On,[(c(),m(aa,null,ea(x,h=>a("button",{key:h.id,onClick:o=>b.value=h.id,class:Z(["tab-button",{active:b.value===h.id}])},[a("i",{class:Z(h.icon)},null,2),_(" "+u(h.label),1)],10,qn)),64))]),a("div",En,[(c(),va(ga(S.value)))])])]))}},Wn=ta(Fn,[["__scopeId","data-v-ef66128e"]]);export{Wn as default};
