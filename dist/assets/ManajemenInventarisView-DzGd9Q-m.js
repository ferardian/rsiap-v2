import{r as T,y as pt,o as bt,a as M,i as N,b as t,e as K,A as j,B as R,D as L,F as W,f as Z,t as x,z as G,j as O,c as gt,n as ft,G as Ut,m as ae,p as oe}from"./vendor-abe1rO6K.js";import{a as V}from"./asetInventarisService-8MSbNnQZ.js";import{a as at}from"./asetMasterService-CzE20kzM.js";import{S as J}from"./SearchableSelect-Lnl9dbY0.js";import{_ as it}from"./index-CXPIpl-L.js";import{pegawaiService as se}from"./pegawaiService-B330j5v3.js";import"./api-B9ygI19o.js";const ie={class:"tab-container"},le={class:"header-action"},re={class:"search-box"},de={class:"table-responsive"},ue={class:"data-table"},ce={key:0},ge={key:1},fe={class:"font-semibold"},me={class:"text-xs text-slate-500"},he={class:"text-xs text-slate-500"},pe={class:"text-xs text-slate-500"},be={class:"text-xs text-slate-500"},_e={class:"badge blue"},ve={class:"text-xs text-slate-500"},ye={class:"action-group"},ke=["onClick"],we=["onClick"],Ce={class:"modal-content"},Ie={class:"modal-header"},Be={class:"modal-body"},Ee={class:"form-group"},Se=["disabled"],xe={key:0,class:"text-hint"},Pe={class:"form-group"},Ne={class:"form-row"},Me={class:"form-group"},Te={class:"form-group"},Ae={class:"form-row"},De={class:"form-group"},je={class:"form-group"},Re={class:"form-row"},Ue={class:"form-group"},Ve={class:"form-group"},$e={class:"form-group"},Le={class:"modal-footer"},He=["disabled"],Fe={__name:"KoleksiBarangTab",setup(n){const e=T([]),i=T(!1),s=T(""),a=T(!1),o=T(!1),l=T(!1),r=pt({kode_barang:"",nama_barang:"",id_merk:"",kode_produsen:"",id_kategori:"",id_jenis:"",thn_produksi:"",isbn:"",jml_barang:0}),d=T([]),_=T([]),f=T([]),P=T([]),k=async()=>{i.value=!0;try{const u=await V.getBarang({search:s.value,limit:100});u.data.data&&(e.value=u.data.data.data,d.value.length===0&&v())}catch(u){console.error(u)}finally{i.value=!1}},v=async()=>{try{const[u,c,m,p]=await Promise.all([at.getMerk({limit:1e3}),at.getProdusen({limit:1e3}),at.getKategori({limit:1e3}),at.getJenis({limit:1e3})]);u.data.data&&(d.value=u.data.data.data),c.data.data&&(_.value=c.data.data.data),m.data.data&&(f.value=m.data.data.data),p.data.data&&(P.value=p.data.data.data)}catch(u){console.error("Gagal ambil options",u)}},I=()=>{o.value=!1,w(),a.value=!0},B=()=>{a.value=!1},D=u=>{o.value=!0,Object.assign(r,{kode_barang:u.kode_barang,nama_barang:u.nama_barang,id_merk:u.id_merk,kode_produsen:u.kode_produsen,id_kategori:u.id_kategori,id_jenis:u.id_jenis,thn_produksi:u.thn_produksi,isbn:u.isbn,jml_barang:u.jml_barang}),a.value=!0},w=async()=>{let u=1;try{const m=await V.getBarang({limit:1,sort_by:"kode_barang",order:"desc"});if(m.data.data&&m.data.data.data.length>0){const p=m.data.data.data[0];p.kode_barang&&/^BI\d+$/.test(p.kode_barang)&&(u=parseInt(p.kode_barang.replace("BI",""),10)+1)}}catch(m){console.error("Failed to fetch max ID for suggestion",m)}const c="BI"+u.toString().padStart(8,"0");Object.assign(r,{kode_barang:c,nama_barang:"",id_merk:"",kode_produsen:"",id_kategori:"",id_jenis:"",thn_produksi:"",isbn:"",jml_barang:0})},E=async()=>{var u,c;l.value=!0;try{if(o.value)await V.updateBarang(r.kode_barang,r);else{if(!r.kode_barang){const m="KB"+Date.now().toString().slice(-6);r.kode_barang=m}await V.createBarang(r)}B(),k()}catch(m){alert("Gagal simpan data: "+(((c=(u=m.response)==null?void 0:u.data)==null?void 0:c.message)||m.message))}finally{l.value=!1}},h=async u=>{if(confirm("Hapus master barang ini?"))try{await V.deleteBarang(u),k()}catch{alert("Gagal hapus")}};return bt(()=>k()),(u,c)=>(N(),M("div",ie,[t("div",le,[t("div",re,[j(t("input",{"onUpdate:modelValue":c[0]||(c[0]=m=>s.value=m),onInput:k,type:"text",placeholder:"Cari Master Barang...",class:"form-input"},null,544),[[R,s.value]])]),t("button",{onClick:I,class:"btn-add"},[...c[10]||(c[10]=[t("i",{class:"fas fa-plus"},null,-1),L(" Tambah Master Barang ",-1)])])]),t("div",de,[t("table",ue,[c[15]||(c[15]=t("thead",null,[t("tr",null,[t("th",null,"Kode"),t("th",null,"Nama Barang"),t("th",null,"Detail"),t("th",null,"Merk/Prod"),t("th",null,"Kat/Jenis"),t("th",{width:"100"},"Aksi")])],-1)),t("tbody",null,[i.value?(N(),M("tr",ce,[...c[11]||(c[11]=[t("td",{colspan:"6",class:"text-center"},"Memuat...",-1)])])):e.value.length===0?(N(),M("tr",ge,[...c[12]||(c[12]=[t("td",{colspan:"6",class:"text-center"},"Data kosong",-1)])])):(N(!0),M(W,{key:2},Z(e.value,m=>{var p,b,C,A;return N(),M("tr",{key:m.kode_barang},[t("td",null,x(m.kode_barang),1),t("td",fe,x(m.nama_barang),1),t("td",null,[t("div",me,"Jml: "+x(m.jml_barang||0),1),t("div",he,x(m.thn_produksi?"Thn: "+m.thn_produksi:""),1)]),t("td",null,[t("div",pe,"Merk: "+x(((p=m.merk)==null?void 0:p.nama_merk)||"-"),1),t("div",be,"Prod: "+x(((b=m.produsen)==null?void 0:b.nama_produsen)||"-"),1)]),t("td",null,[t("div",_e,x(((C=m.kategori)==null?void 0:C.nama_kategori)||"-"),1),t("div",ve,x(((A=m.jenis)==null?void 0:A.nama_jenis)||"-"),1)]),t("td",null,[t("div",ye,[t("button",{class:"btn-icon text-blue",onClick:U=>D(m)},[...c[13]||(c[13]=[t("i",{class:"fas fa-edit"},null,-1)])],8,ke),t("button",{class:"btn-icon text-red",onClick:U=>h(m.kode_barang)},[...c[14]||(c[14]=[t("i",{class:"fas fa-trash"},null,-1)])],8,we)])])])}),128))])])]),a.value?(N(),M("div",{key:0,class:"modal-overlay",onClick:G(B,["self"])},[t("div",Ce,[t("div",Ie,[t("h3",null,x(o.value?"Edit":"Tambah")+" Master Barang",1),t("button",{onClick:B,class:"close-btn"},"×")]),t("form",{onSubmit:G(E,["prevent"])},[t("div",Be,[t("div",Ee,[c[16]||(c[16]=t("label",null,"Kode Barang",-1)),j(t("input",{"onUpdate:modelValue":c[1]||(c[1]=m=>r.kode_barang=m),type:"text",class:"form-input",placeholder:"Otomatis jika kosong",disabled:o.value},null,8,Se),[[R,r.kode_barang]]),o.value?K("",!0):(N(),M("small",xe,"Biarkan kosong untuk generate otomatis (KB...)"))]),t("div",Pe,[c[17]||(c[17]=t("label",null,[L("Nama Barang "),t("span",{class:"text-red"},"*")],-1)),j(t("input",{"onUpdate:modelValue":c[2]||(c[2]=m=>r.nama_barang=m),type:"text",class:"form-input",required:""},null,512),[[R,r.nama_barang]])]),t("div",Ne,[t("div",Me,[c[18]||(c[18]=t("label",null,"Merk",-1)),O(J,{modelValue:r.id_merk,"onUpdate:modelValue":c[3]||(c[3]=m=>r.id_merk=m),options:d.value,"label-key":"nama_merk","value-key":"id_merk",placeholder:"Pilih Merk"},null,8,["modelValue","options"])]),t("div",Te,[c[19]||(c[19]=t("label",null,"Produsen",-1)),O(J,{modelValue:r.kode_produsen,"onUpdate:modelValue":c[4]||(c[4]=m=>r.kode_produsen=m),options:_.value,"label-key":"nama_produsen","value-key":"kode_produsen",placeholder:"Pilih Produsen"},null,8,["modelValue","options"])])]),t("div",Ae,[t("div",De,[c[20]||(c[20]=t("label",null,"Kategori",-1)),O(J,{modelValue:r.id_kategori,"onUpdate:modelValue":c[5]||(c[5]=m=>r.id_kategori=m),options:f.value,"label-key":"nama_kategori","value-key":"id_kategori",placeholder:"Pilih Kategori"},null,8,["modelValue","options"])]),t("div",je,[c[21]||(c[21]=t("label",null,"Jenis",-1)),O(J,{modelValue:r.id_jenis,"onUpdate:modelValue":c[6]||(c[6]=m=>r.id_jenis=m),options:P.value,"label-key":"nama_jenis","value-key":"id_jenis",placeholder:"Pilih Jenis"},null,8,["modelValue","options"])])]),t("div",Re,[t("div",Ue,[c[22]||(c[22]=t("label",null,"Tahun Produksi",-1)),j(t("input",{"onUpdate:modelValue":c[7]||(c[7]=m=>r.thn_produksi=m),type:"number",class:"form-input",placeholder:"YYYY"},null,512),[[R,r.thn_produksi]])]),t("div",Ve,[c[23]||(c[23]=t("label",null,"ISBN",-1)),j(t("input",{"onUpdate:modelValue":c[8]||(c[8]=m=>r.isbn=m),type:"text",class:"form-input"},null,512),[[R,r.isbn]])])]),t("div",$e,[c[24]||(c[24]=t("label",null,"Jumlah Barang",-1)),j(t("input",{"onUpdate:modelValue":c[9]||(c[9]=m=>r.jml_barang=m),type:"number",class:"form-input",readonly:"",title:"Jumlah dihitung dari item inventaris"},null,512),[[R,r.jml_barang]]),c[25]||(c[25]=t("small",{class:"text-hint"},"Jumlah otomatis update dari item inventaris",-1))])]),t("div",Le,[t("button",{type:"button",onClick:B,class:"btn-cancel"},"Batal"),t("button",{type:"submit",class:"btn-save",disabled:l.value},x(l.value?"Menyimpan...":"Simpan"),9,He)])],32)])])):K("",!0)]))}},Ke=it(Fe,[["__scopeId","data-v-a462c210"]]);var lt={},ze=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Ht={},F={};let Mt;const Oe=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];F.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};F.getSymbolTotalCodewords=function(e){return Oe[e]};F.getBCHDigit=function(n){let e=0;for(;n!==0;)e++,n>>>=1;return e};F.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Mt=e};F.isKanjiModeEnabled=function(){return typeof Mt<"u"};F.toSJIS=function(e){return Mt(e)};var _t={};(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+i)}}n.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},n.from=function(s,a){if(n.isValid(s))return s;try{return e(s)}catch{return a}}})(_t);function Ft(){this.buffer=[],this.length=0}Ft.prototype={get:function(n){const e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let i=0;i<e;i++)this.putBit((n>>>e-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var Je=Ft;function rt(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}rt.prototype.set=function(n,e,i,s){const a=n*this.size+e;this.data[a]=i,s&&(this.reservedBit[a]=!0)};rt.prototype.get=function(n,e){return this.data[n*this.size+e]};rt.prototype.xor=function(n,e,i){this.data[n*this.size+e]^=i};rt.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]};var Ge=rt,Kt={};(function(n){const e=F.getSymbolSize;n.getRowColCoords=function(s){if(s===1)return[];const a=Math.floor(s/7)+2,o=e(s),l=o===145?26:Math.ceil((o-13)/(2*a-2))*2,r=[o-7];for(let d=1;d<a-1;d++)r[d]=r[d-1]-l;return r.push(6),r.reverse()},n.getPositions=function(s){const a=[],o=n.getRowColCoords(s),l=o.length;for(let r=0;r<l;r++)for(let d=0;d<l;d++)r===0&&d===0||r===0&&d===l-1||r===l-1&&d===0||a.push([o[r],o[d]]);return a}})(Kt);var zt={};const Ye=F.getSymbolSize,Vt=7;zt.getPositions=function(e){const i=Ye(e);return[[0,0],[i-Vt,0],[0,i-Vt]]};var Ot={};(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},n.from=function(a){return n.isValid(a)?parseInt(a,10):void 0},n.getPenaltyN1=function(a){const o=a.size;let l=0,r=0,d=0,_=null,f=null;for(let P=0;P<o;P++){r=d=0,_=f=null;for(let k=0;k<o;k++){let v=a.get(P,k);v===_?r++:(r>=5&&(l+=e.N1+(r-5)),_=v,r=1),v=a.get(k,P),v===f?d++:(d>=5&&(l+=e.N1+(d-5)),f=v,d=1)}r>=5&&(l+=e.N1+(r-5)),d>=5&&(l+=e.N1+(d-5))}return l},n.getPenaltyN2=function(a){const o=a.size;let l=0;for(let r=0;r<o-1;r++)for(let d=0;d<o-1;d++){const _=a.get(r,d)+a.get(r,d+1)+a.get(r+1,d)+a.get(r+1,d+1);(_===4||_===0)&&l++}return l*e.N2},n.getPenaltyN3=function(a){const o=a.size;let l=0,r=0,d=0;for(let _=0;_<o;_++){r=d=0;for(let f=0;f<o;f++)r=r<<1&2047|a.get(_,f),f>=10&&(r===1488||r===93)&&l++,d=d<<1&2047|a.get(f,_),f>=10&&(d===1488||d===93)&&l++}return l*e.N3},n.getPenaltyN4=function(a){let o=0;const l=a.data.length;for(let d=0;d<l;d++)o+=a.data[d];return Math.abs(Math.ceil(o*100/l/5)-10)*e.N4};function i(s,a,o){switch(s){case n.Patterns.PATTERN000:return(a+o)%2===0;case n.Patterns.PATTERN001:return a%2===0;case n.Patterns.PATTERN010:return o%3===0;case n.Patterns.PATTERN011:return(a+o)%3===0;case n.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(o/3))%2===0;case n.Patterns.PATTERN101:return a*o%2+a*o%3===0;case n.Patterns.PATTERN110:return(a*o%2+a*o%3)%2===0;case n.Patterns.PATTERN111:return(a*o%3+(a+o)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}n.applyMask=function(a,o){const l=o.size;for(let r=0;r<l;r++)for(let d=0;d<l;d++)o.isReserved(d,r)||o.xor(d,r,i(a,d,r))},n.getBestMask=function(a,o){const l=Object.keys(n.Patterns).length;let r=0,d=1/0;for(let _=0;_<l;_++){o(_),n.applyMask(_,a);const f=n.getPenaltyN1(a)+n.getPenaltyN2(a)+n.getPenaltyN3(a)+n.getPenaltyN4(a);n.applyMask(_,a),f<d&&(d=f,r=_)}return r}})(Ot);var vt={};const q=_t,ut=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ct=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];vt.getBlocksCount=function(e,i){switch(i){case q.L:return ut[(e-1)*4+0];case q.M:return ut[(e-1)*4+1];case q.Q:return ut[(e-1)*4+2];case q.H:return ut[(e-1)*4+3];default:return}};vt.getTotalCodewordsCount=function(e,i){switch(i){case q.L:return ct[(e-1)*4+0];case q.M:return ct[(e-1)*4+1];case q.Q:return ct[(e-1)*4+2];case q.H:return ct[(e-1)*4+3];default:return}};var Jt={},yt={};const ot=new Uint8Array(512),mt=new Uint8Array(256);(function(){let e=1;for(let i=0;i<255;i++)ot[i]=e,mt[e]=i,e<<=1,e&256&&(e^=285);for(let i=255;i<512;i++)ot[i]=ot[i-255]})();yt.log=function(e){if(e<1)throw new Error("log("+e+")");return mt[e]};yt.exp=function(e){return ot[e]};yt.mul=function(e,i){return e===0||i===0?0:ot[mt[e]+mt[i]]};(function(n){const e=yt;n.mul=function(s,a){const o=new Uint8Array(s.length+a.length-1);for(let l=0;l<s.length;l++)for(let r=0;r<a.length;r++)o[l+r]^=e.mul(s[l],a[r]);return o},n.mod=function(s,a){let o=new Uint8Array(s);for(;o.length-a.length>=0;){const l=o[0];for(let d=0;d<a.length;d++)o[d]^=e.mul(a[d],l);let r=0;for(;r<o.length&&o[r]===0;)r++;o=o.slice(r)}return o},n.generateECPolynomial=function(s){let a=new Uint8Array([1]);for(let o=0;o<s;o++)a=n.mul(a,new Uint8Array([1,e.exp(o)]));return a}})(Jt);const Gt=Jt;function Tt(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}Tt.prototype.initialize=function(e){this.degree=e,this.genPoly=Gt.generateECPolynomial(this.degree)};Tt.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const i=new Uint8Array(e.length+this.degree);i.set(e);const s=Gt.mod(i,this.genPoly),a=this.degree-s.length;if(a>0){const o=new Uint8Array(this.degree);return o.set(s,a),o}return s};var qe=Tt,Yt={},Q={},At={};At.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var z={};const qt="[0-9]+",Qe="[A-Z $%*+\\-./:]+";let st="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";st=st.replace(/u/g,"\\u");const We="(?:(?![A-Z0-9 $%*+\\-./:]|"+st+`)(?:.|[\r
]))+`;z.KANJI=new RegExp(st,"g");z.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");z.BYTE=new RegExp(We,"g");z.NUMERIC=new RegExp(qt,"g");z.ALPHANUMERIC=new RegExp(Qe,"g");const Ze=new RegExp("^"+st+"$"),Xe=new RegExp("^"+qt+"$"),tn=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");z.testKanji=function(e){return Ze.test(e)};z.testNumeric=function(e){return Xe.test(e)};z.testAlphanumeric=function(e){return tn.test(e)};(function(n){const e=At,i=z;n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(o,l){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!e.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?o.ccBits[0]:l<27?o.ccBits[1]:o.ccBits[2]},n.getBestModeForData=function(o){return i.testNumeric(o)?n.NUMERIC:i.testAlphanumeric(o)?n.ALPHANUMERIC:i.testKanji(o)?n.KANJI:n.BYTE},n.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},n.isValid=function(o){return o&&o.bit&&o.ccBits};function s(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+a)}}n.from=function(o,l){if(n.isValid(o))return o;try{return s(o)}catch{return l}}})(Q);(function(n){const e=F,i=vt,s=_t,a=Q,o=At,l=7973,r=e.getBCHDigit(l);function d(k,v,I){for(let B=1;B<=40;B++)if(v<=n.getCapacity(B,I,k))return B}function _(k,v){return a.getCharCountIndicator(k,v)+4}function f(k,v){let I=0;return k.forEach(function(B){const D=_(B.mode,v);I+=D+B.getBitsLength()}),I}function P(k,v){for(let I=1;I<=40;I++)if(f(k,I)<=n.getCapacity(I,v,a.MIXED))return I}n.from=function(v,I){return o.isValid(v)?parseInt(v,10):I},n.getCapacity=function(v,I,B){if(!o.isValid(v))throw new Error("Invalid QR Code version");typeof B>"u"&&(B=a.BYTE);const D=e.getSymbolTotalCodewords(v),w=i.getTotalCodewordsCount(v,I),E=(D-w)*8;if(B===a.MIXED)return E;const h=E-_(B,v);switch(B){case a.NUMERIC:return Math.floor(h/10*3);case a.ALPHANUMERIC:return Math.floor(h/11*2);case a.KANJI:return Math.floor(h/13);case a.BYTE:default:return Math.floor(h/8)}},n.getBestVersionForData=function(v,I){let B;const D=s.from(I,s.M);if(Array.isArray(v)){if(v.length>1)return P(v,D);if(v.length===0)return 1;B=v[0]}else B=v;return d(B.mode,B.getLength(),D)},n.getEncodedBits=function(v){if(!o.isValid(v)||v<7)throw new Error("Invalid QR Code version");let I=v<<12;for(;e.getBCHDigit(I)-r>=0;)I^=l<<e.getBCHDigit(I)-r;return v<<12|I}})(Yt);var Qt={};const St=F,Wt=1335,en=21522,$t=St.getBCHDigit(Wt);Qt.getEncodedBits=function(e,i){const s=e.bit<<3|i;let a=s<<10;for(;St.getBCHDigit(a)-$t>=0;)a^=Wt<<St.getBCHDigit(a)-$t;return(s<<10|a)^en};var Zt={};const nn=Q;function X(n){this.mode=nn.NUMERIC,this.data=n.toString()}X.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};X.prototype.getLength=function(){return this.data.length};X.prototype.getBitsLength=function(){return X.getBitsLength(this.data.length)};X.prototype.write=function(e){let i,s,a;for(i=0;i+3<=this.data.length;i+=3)s=this.data.substr(i,3),a=parseInt(s,10),e.put(a,10);const o=this.data.length-i;o>0&&(s=this.data.substr(i),a=parseInt(s,10),e.put(a,o*3+1))};var an=X;const on=Q,wt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function tt(n){this.mode=on.ALPHANUMERIC,this.data=n}tt.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};tt.prototype.getLength=function(){return this.data.length};tt.prototype.getBitsLength=function(){return tt.getBitsLength(this.data.length)};tt.prototype.write=function(e){let i;for(i=0;i+2<=this.data.length;i+=2){let s=wt.indexOf(this.data[i])*45;s+=wt.indexOf(this.data[i+1]),e.put(s,11)}this.data.length%2&&e.put(wt.indexOf(this.data[i]),6)};var sn=tt;const ln=Q;function et(n){this.mode=ln.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}et.getBitsLength=function(e){return e*8};et.prototype.getLength=function(){return this.data.length};et.prototype.getBitsLength=function(){return et.getBitsLength(this.data.length)};et.prototype.write=function(n){for(let e=0,i=this.data.length;e<i;e++)n.put(this.data[e],8)};var rn=et;const dn=Q,un=F;function nt(n){this.mode=dn.KANJI,this.data=n}nt.getBitsLength=function(e){return e*13};nt.prototype.getLength=function(){return this.data.length};nt.prototype.getBitsLength=function(){return nt.getBitsLength(this.data.length)};nt.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let i=un.toSJIS(this.data[e]);if(i>=33088&&i<=40956)i-=33088;else if(i>=57408&&i<=60351)i-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);i=(i>>>8&255)*192+(i&255),n.put(i,13)}};var cn=nt,Xt={exports:{}};(function(n){var e={single_source_shortest_paths:function(i,s,a){var o={},l={};l[s]=0;var r=e.PriorityQueue.make();r.push(s,0);for(var d,_,f,P,k,v,I,B,D;!r.empty();){d=r.pop(),_=d.value,P=d.cost,k=i[_]||{};for(f in k)k.hasOwnProperty(f)&&(v=k[f],I=P+v,B=l[f],D=typeof l[f]>"u",(D||B>I)&&(l[f]=I,r.push(f,I),o[f]=_))}if(typeof a<"u"&&typeof l[a]>"u"){var w=["Could not find a path from ",s," to ",a,"."].join("");throw new Error(w)}return o},extract_shortest_path_from_predecessor_list:function(i,s){for(var a=[],o=s;o;)a.push(o),i[o],o=i[o];return a.reverse(),a},find_path:function(i,s,a){var o=e.single_source_shortest_paths(i,s,a);return e.extract_shortest_path_from_predecessor_list(o,a)},PriorityQueue:{make:function(i){var s=e.PriorityQueue,a={},o;i=i||{};for(o in s)s.hasOwnProperty(o)&&(a[o]=s[o]);return a.queue=[],a.sorter=i.sorter||s.default_sorter,a},default_sorter:function(i,s){return i.cost-s.cost},push:function(i,s){var a={value:i,cost:s};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(Xt);var gn=Xt.exports;(function(n){const e=Q,i=an,s=sn,a=rn,o=cn,l=z,r=F,d=gn;function _(w){return unescape(encodeURIComponent(w)).length}function f(w,E,h){const u=[];let c;for(;(c=w.exec(h))!==null;)u.push({data:c[0],index:c.index,mode:E,length:c[0].length});return u}function P(w){const E=f(l.NUMERIC,e.NUMERIC,w),h=f(l.ALPHANUMERIC,e.ALPHANUMERIC,w);let u,c;return r.isKanjiModeEnabled()?(u=f(l.BYTE,e.BYTE,w),c=f(l.KANJI,e.KANJI,w)):(u=f(l.BYTE_KANJI,e.BYTE,w),c=[]),E.concat(h,u,c).sort(function(p,b){return p.index-b.index}).map(function(p){return{data:p.data,mode:p.mode,length:p.length}})}function k(w,E){switch(E){case e.NUMERIC:return i.getBitsLength(w);case e.ALPHANUMERIC:return s.getBitsLength(w);case e.KANJI:return o.getBitsLength(w);case e.BYTE:return a.getBitsLength(w)}}function v(w){return w.reduce(function(E,h){const u=E.length-1>=0?E[E.length-1]:null;return u&&u.mode===h.mode?(E[E.length-1].data+=h.data,E):(E.push(h),E)},[])}function I(w){const E=[];for(let h=0;h<w.length;h++){const u=w[h];switch(u.mode){case e.NUMERIC:E.push([u,{data:u.data,mode:e.ALPHANUMERIC,length:u.length},{data:u.data,mode:e.BYTE,length:u.length}]);break;case e.ALPHANUMERIC:E.push([u,{data:u.data,mode:e.BYTE,length:u.length}]);break;case e.KANJI:E.push([u,{data:u.data,mode:e.BYTE,length:_(u.data)}]);break;case e.BYTE:E.push([{data:u.data,mode:e.BYTE,length:_(u.data)}])}}return E}function B(w,E){const h={},u={start:{}};let c=["start"];for(let m=0;m<w.length;m++){const p=w[m],b=[];for(let C=0;C<p.length;C++){const A=p[C],U=""+m+C;b.push(U),h[U]={node:A,lastCount:0},u[U]={};for(let y=0;y<c.length;y++){const g=c[y];h[g]&&h[g].node.mode===A.mode?(u[g][U]=k(h[g].lastCount+A.length,A.mode)-k(h[g].lastCount,A.mode),h[g].lastCount+=A.length):(h[g]&&(h[g].lastCount=A.length),u[g][U]=k(A.length,A.mode)+4+e.getCharCountIndicator(A.mode,E))}}c=b}for(let m=0;m<c.length;m++)u[c[m]].end=0;return{map:u,table:h}}function D(w,E){let h;const u=e.getBestModeForData(w);if(h=e.from(E,u),h!==e.BYTE&&h.bit<u.bit)throw new Error('"'+w+'" cannot be encoded with mode '+e.toString(h)+`.
 Suggested mode is: `+e.toString(u));switch(h===e.KANJI&&!r.isKanjiModeEnabled()&&(h=e.BYTE),h){case e.NUMERIC:return new i(w);case e.ALPHANUMERIC:return new s(w);case e.KANJI:return new o(w);case e.BYTE:return new a(w)}}n.fromArray=function(E){return E.reduce(function(h,u){return typeof u=="string"?h.push(D(u,null)):u.data&&h.push(D(u.data,u.mode)),h},[])},n.fromString=function(E,h){const u=P(E,r.isKanjiModeEnabled()),c=I(u),m=B(c,h),p=d.find_path(m.map,"start","end"),b=[];for(let C=1;C<p.length-1;C++)b.push(m.table[p[C]].node);return n.fromArray(v(b))},n.rawSplit=function(E){return n.fromArray(P(E,r.isKanjiModeEnabled()))}})(Zt);const kt=F,Ct=_t,fn=Je,mn=Ge,hn=Kt,pn=zt,xt=Ot,Pt=vt,bn=qe,ht=Yt,_n=Qt,vn=Q,It=Zt;function yn(n,e){const i=n.size,s=pn.getPositions(e);for(let a=0;a<s.length;a++){const o=s[a][0],l=s[a][1];for(let r=-1;r<=7;r++)if(!(o+r<=-1||i<=o+r))for(let d=-1;d<=7;d++)l+d<=-1||i<=l+d||(r>=0&&r<=6&&(d===0||d===6)||d>=0&&d<=6&&(r===0||r===6)||r>=2&&r<=4&&d>=2&&d<=4?n.set(o+r,l+d,!0,!0):n.set(o+r,l+d,!1,!0))}}function kn(n){const e=n.size;for(let i=8;i<e-8;i++){const s=i%2===0;n.set(i,6,s,!0),n.set(6,i,s,!0)}}function wn(n,e){const i=hn.getPositions(e);for(let s=0;s<i.length;s++){const a=i[s][0],o=i[s][1];for(let l=-2;l<=2;l++)for(let r=-2;r<=2;r++)l===-2||l===2||r===-2||r===2||l===0&&r===0?n.set(a+l,o+r,!0,!0):n.set(a+l,o+r,!1,!0)}}function Cn(n,e){const i=n.size,s=ht.getEncodedBits(e);let a,o,l;for(let r=0;r<18;r++)a=Math.floor(r/3),o=r%3+i-8-3,l=(s>>r&1)===1,n.set(a,o,l,!0),n.set(o,a,l,!0)}function Bt(n,e,i){const s=n.size,a=_n.getEncodedBits(e,i);let o,l;for(o=0;o<15;o++)l=(a>>o&1)===1,o<6?n.set(o,8,l,!0):o<8?n.set(o+1,8,l,!0):n.set(s-15+o,8,l,!0),o<8?n.set(8,s-o-1,l,!0):o<9?n.set(8,15-o-1+1,l,!0):n.set(8,15-o-1,l,!0);n.set(s-8,8,1,!0)}function In(n,e){const i=n.size;let s=-1,a=i-1,o=7,l=0;for(let r=i-1;r>0;r-=2)for(r===6&&r--;;){for(let d=0;d<2;d++)if(!n.isReserved(a,r-d)){let _=!1;l<e.length&&(_=(e[l]>>>o&1)===1),n.set(a,r-d,_),o--,o===-1&&(l++,o=7)}if(a+=s,a<0||i<=a){a-=s,s=-s;break}}}function Bn(n,e,i){const s=new fn;i.forEach(function(d){s.put(d.mode.bit,4),s.put(d.getLength(),vn.getCharCountIndicator(d.mode,n)),d.write(s)});const a=kt.getSymbolTotalCodewords(n),o=Pt.getTotalCodewordsCount(n,e),l=(a-o)*8;for(s.getLengthInBits()+4<=l&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const r=(l-s.getLengthInBits())/8;for(let d=0;d<r;d++)s.put(d%2?17:236,8);return En(s,n,e)}function En(n,e,i){const s=kt.getSymbolTotalCodewords(e),a=Pt.getTotalCodewordsCount(e,i),o=s-a,l=Pt.getBlocksCount(e,i),r=s%l,d=l-r,_=Math.floor(s/l),f=Math.floor(o/l),P=f+1,k=_-f,v=new bn(k);let I=0;const B=new Array(l),D=new Array(l);let w=0;const E=new Uint8Array(n.buffer);for(let p=0;p<l;p++){const b=p<d?f:P;B[p]=E.slice(I,I+b),D[p]=v.encode(B[p]),I+=b,w=Math.max(w,b)}const h=new Uint8Array(s);let u=0,c,m;for(c=0;c<w;c++)for(m=0;m<l;m++)c<B[m].length&&(h[u++]=B[m][c]);for(c=0;c<k;c++)for(m=0;m<l;m++)h[u++]=D[m][c];return h}function Sn(n,e,i,s){let a;if(Array.isArray(n))a=It.fromArray(n);else if(typeof n=="string"){let _=e;if(!_){const f=It.rawSplit(n);_=ht.getBestVersionForData(f,i)}a=It.fromString(n,_||40)}else throw new Error("Invalid data");const o=ht.getBestVersionForData(a,i);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=o;else if(e<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);const l=Bn(e,i,a),r=kt.getSymbolSize(e),d=new mn(r);return yn(d,e),kn(d),wn(d,e),Bt(d,i,0),e>=7&&Cn(d,e),In(d,l),isNaN(s)&&(s=xt.getBestMask(d,Bt.bind(null,d,i))),xt.applyMask(s,d),Bt(d,i,s),{modules:d,version:e,errorCorrectionLevel:i,maskPattern:s,segments:a}}Ht.create=function(e,i){if(typeof e>"u"||e==="")throw new Error("No input text");let s=Ct.M,a,o;return typeof i<"u"&&(s=Ct.from(i.errorCorrectionLevel,Ct.M),a=ht.from(i.version),o=xt.from(i.maskPattern),i.toSJISFunc&&kt.setToSJISFunction(i.toSJISFunc)),Sn(e,a,s,o)};var te={},Dt={};(function(n){function e(i){if(typeof i=="number"&&(i=i.toString()),typeof i!="string")throw new Error("Color should be defined as hex string");let s=i.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+i);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(o){return[o,o]}))),s.length===6&&s.push("F","F");const a=parseInt(s.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+s.slice(0,6).join("")}}n.getOptions=function(s){s||(s={}),s.color||(s.color={});const a=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,o=s.width&&s.width>=21?s.width:void 0,l=s.scale||4;return{width:o,scale:o?4:l,margin:a,color:{dark:e(s.color.dark||"#000000ff"),light:e(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},n.getScale=function(s,a){return a.width&&a.width>=s+a.margin*2?a.width/(s+a.margin*2):a.scale},n.getImageWidth=function(s,a){const o=n.getScale(s,a);return Math.floor((s+a.margin*2)*o)},n.qrToImageData=function(s,a,o){const l=a.modules.size,r=a.modules.data,d=n.getScale(l,o),_=Math.floor((l+o.margin*2)*d),f=o.margin*d,P=[o.color.light,o.color.dark];for(let k=0;k<_;k++)for(let v=0;v<_;v++){let I=(k*_+v)*4,B=o.color.light;if(k>=f&&v>=f&&k<_-f&&v<_-f){const D=Math.floor((k-f)/d),w=Math.floor((v-f)/d);B=P[r[D*l+w]?1:0]}s[I++]=B.r,s[I++]=B.g,s[I++]=B.b,s[I]=B.a}}})(Dt);(function(n){const e=Dt;function i(a,o,l){a.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=l,o.width=l,o.style.height=l+"px",o.style.width=l+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(o,l,r){let d=r,_=l;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),l||(_=s()),d=e.getOptions(d);const f=e.getImageWidth(o.modules.size,d),P=_.getContext("2d"),k=P.createImageData(f,f);return e.qrToImageData(k.data,o,d),i(P,_,f),P.putImageData(k,0,0),_},n.renderToDataURL=function(o,l,r){let d=r;typeof d>"u"&&(!l||!l.getContext)&&(d=l,l=void 0),d||(d={});const _=n.render(o,l,d),f=d.type||"image/png",P=d.rendererOpts||{};return _.toDataURL(f,P.quality)}})(te);var ee={};const xn=Dt;function Lt(n,e){const i=n.a/255,s=e+'="'+n.hex+'"';return i<1?s+" "+e+'-opacity="'+i.toFixed(2).slice(1)+'"':s}function Et(n,e,i){let s=n+e;return typeof i<"u"&&(s+=" "+i),s}function Pn(n,e,i){let s="",a=0,o=!1,l=0;for(let r=0;r<n.length;r++){const d=Math.floor(r%e),_=Math.floor(r/e);!d&&!o&&(o=!0),n[r]?(l++,r>0&&d>0&&n[r-1]||(s+=o?Et("M",d+i,.5+_+i):Et("m",a,0),a=0,o=!1),d+1<e&&n[r+1]||(s+=Et("h",l),l=0)):a++}return s}ee.render=function(e,i,s){const a=xn.getOptions(i),o=e.modules.size,l=e.modules.data,r=o+a.margin*2,d=a.color.light.a?"<path "+Lt(a.color.light,"fill")+' d="M0 0h'+r+"v"+r+'H0z"/>':"",_="<path "+Lt(a.color.dark,"stroke")+' d="'+Pn(l,o,a.margin)+'"/>',f='viewBox="0 0 '+r+" "+r+'"',k='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+f+' shape-rendering="crispEdges">'+d+_+`</svg>
`;return typeof s=="function"&&s(null,k),k};const Nn=ze,Nt=Ht,ne=te,Mn=ee;function jt(n,e,i,s,a){const o=[].slice.call(arguments,1),l=o.length,r=typeof o[l-1]=="function";if(!r&&!Nn())throw new Error("Callback required as last argument");if(r){if(l<2)throw new Error("Too few arguments provided");l===2?(a=i,i=e,e=s=void 0):l===3&&(e.getContext&&typeof a>"u"?(a=s,s=void 0):(a=s,s=i,i=e,e=void 0))}else{if(l<1)throw new Error("Too few arguments provided");return l===1?(i=e,e=s=void 0):l===2&&!e.getContext&&(s=i,i=e,e=void 0),new Promise(function(d,_){try{const f=Nt.create(i,s);d(n(f,e,s))}catch(f){_(f)}})}try{const d=Nt.create(i,s);a(null,n(d,e,s))}catch(d){a(d)}}lt.create=Nt.create;lt.toCanvas=jt.bind(null,ne.render);lt.toDataURL=jt.bind(null,ne.renderToDataURL);lt.toString=jt.bind(null,function(n,e,i){return Mn.render(n,i)});const Tn={class:"tab-container"},An={class:"header-action"},Dn={class:"search-box"},jn={key:0,class:"summary-wrapper"},Rn={class:"summary-card"},Un={class:"summary-item"},Vn={class:"value"},$n={class:"table-responsive"},Ln={class:"data-table"},Hn={key:0},Fn={key:1},Kn={class:"font-mono text-sm"},zn={class:"font-semibold"},On={class:"text-sm"},Jn={class:"text-xs text-slate-500"},Gn={class:"text-sm font-medium"},Yn={class:"text-xs text-slate-500"},qn={class:"font-medium"},Qn={class:"action-group"},Wn=["onClick"],Zn=["onClick"],Xn=["onClick"],ta={class:"modal-content"},ea={class:"modal-header"},na={class:"modal-body"},aa={class:"form-group"},oa=["disabled"],sa={key:0,class:"text-hint"},ia={class:"form-group"},la={key:0,class:"text-hint"},ra={class:"form-row"},da={class:"form-group"},ua={class:"form-group"},ca={class:"form-row"},ga={class:"form-group"},fa={class:"form-group"},ma={class:"form-row"},ha={class:"form-group"},pa={class:"input-group"},ba={class:"form-group"},_a={class:"form-group"},va={class:"modal-footer"},ya=["disabled"],ka={class:"modal-content sticker-modal-content"},wa={class:"modal-body flex-center"},Ca={class:"sticker-preview-box"},Ia={class:"s-body"},Ba={class:"s-qr"},Ea=["src"],Sa={class:"s-info"},xa={class:"s-kode"},Pa={class:"s-nama"},Na={class:"s-footer"},Ma={__name:"ItemInventarisTab",setup(n){const e=T([]),i=T(!1),s=T(""),a=T(!1),o=T({}),l=T(""),r=T(!1),d=T(!1),_=T(!1),f=pt({no_inventaris:"",kode_barang:"",id_ruang:"",status_barang:"Ada",no_rak:"",no_box:"",harga:0,tgl_pengadaan:"",asal_barang:"Beli"}),P=T([]),k=T([]),v=gt(()=>e.value.reduce((y,g)=>y+(Number(g.harga)||0),0)),I=async()=>{i.value=!0;try{const y=await V.getInventaris({search:s.value,limit:100});y.data.data&&(e.value=y.data.data.data,P.value.length===0&&B())}catch(y){console.error(y)}finally{i.value=!1}},B=async()=>{try{const[y,g]=await Promise.all([V.getBarang({limit:1e3}),at.getRuang({limit:1e3})]);P.value=y.data.data.data||[],k.value=g.data.data.data||[]}catch(y){console.error("Gagal fetch options",y)}},D=()=>{d.value=!1,h(),r.value=!0},w=()=>{r.value=!1},E=y=>{d.value=!0,Object.assign(f,{no_inventaris:y.no_inventaris,kode_barang:y.kode_barang,id_ruang:y.id_ruang,status_barang:y.status_barang,no_rak:y.no_rak,no_box:y.no_box,harga:y.harga,tgl_pengadaan:y.tgl_pengadaan,asal_barang:y.asal_barang}),r.value=!0},h=async()=>{let y=1;try{const $=await V.getInventaris({limit:1,sort_by:"no_inventaris",order:"desc"});if($.data.data){const H=$.data.data.data||$.data.data||[];if(H.length>0){const S=H[0];if(S.no_inventaris&&/^I\d+$/.test(S.no_inventaris)){const Y=S.no_inventaris.replace("I","");y=parseInt(Y,10)+1}}}}catch($){console.error("Failed to fetch max ID for suggestion",$)}const g="I"+y.toString().padStart(9,"0");Object.assign(f,{no_inventaris:g,kode_barang:"",id_ruang:"",status_barang:"Ada",no_rak:"",no_box:"",harga:0,tgl_pengadaan:new Date().toISOString().split("T")[0],asal_barang:"Beli"})},u=async()=>{var y,g;_.value=!0;try{if(d.value)await V.updateInventaris(f.no_inventaris,f);else{if(!f.no_inventaris){const $="INV"+Date.now().toString().slice(-8);f.no_inventaris=$}await V.createInventaris(f)}w(),I()}catch($){alert("Gagal simpan data: "+(((g=(y=$.response)==null?void 0:y.data)==null?void 0:g.message)||$.message))}finally{_.value=!1}},c=async y=>{if(confirm("Hapus item inventaris ini?"))try{await V.deleteInventaris(y),I()}catch{alert("Gagal hapus")}},m=async y=>{o.value=y,a.value=!0;try{l.value=await lt.toDataURL(y.no_inventaris,{width:120,margin:0})}catch(g){console.error(g)}},p=()=>{a.value=!1,o.value={},l.value=""},b=()=>{var H,S;const y=o.value,g=l.value,$=window.open("","_blank","width=400,height=300");$.document.write(`
      <html>
        <head>
          <title>Stiker ${y.no_inventaris}</title>
          <style>
            @page { size: 65mm 40mm; margin: 0; }
            body { 
              width: 65mm; height: 40mm; margin: 0; padding: 0; 
              font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; 
              box-sizing: border-box; overflow: hidden;
              border: 1px dotted #ccc; /* Preview border */
            }
            .sticker-container {
              width: 100%; height: 100%;
              display: flex; flex-direction: column;
              border: 1px solid #000;
              box-sizing: border-box;
            }
            .header { 
              background: #000; color: #fff; 
              text-align: center; font-size: 7.5pt; font-weight: 800; 
              padding: 2px 0; text-transform: uppercase;
              -webkit-print-color-adjust: exact;
            }
            .body-wrap {
              flex: 1; display: flex; align-items: center; padding: 1mm 2mm; gap: 2mm;
            }
            .qr-box { 
              width: 22mm; height: 22mm; 
              display: flex; justify-content: center; align-items: center;
              border: 1px solid #000; border-radius: 4px; padding: 1mm;
            }
            .qr-img { width: 100%; height: 100%; object-fit: contain; }
            .info-box { flex: 1; display: flex; flex-direction: column; justify-content: center; }
            .kode-label { font-size: 6pt; color: #333; text-transform: uppercase; letter-spacing: 0.5px; }
            .kode { font-size: 11pt; font-weight: 900; margin-bottom: 2px; font-family: monospace; letter-spacing: -0.5px; }
            .nama { font-size: 8pt; line-height: 1.1; font-weight: 600; max-height: 24px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
            .footer { 
              border-top: 1px solid #000; padding: 2px 3mm; 
              font-size: 6.5pt; font-weight: 600;
              display: flex; justify-content: space-between;
              background: #f0f0f0;
              -webkit-print-color-adjust: exact;
            }
            @media print {
              body { border: none; }
              .header { background: #000 !important; color: #fff !important; }
              .footer { background: #eee !important; }
            }
          </style>
        </head>
        <body>
          <div class="sticker-container">
            <div class="header">RSIA Aisyiyah Pekajangan</div>
            <div class="body-wrap">
               <div class="qr-box">
                  <img src="${g}" class="qr-img" />
               </div>
               <div class="info-box">
                  <div class="kode-label">No. Inventaris</div>
                  <div class="kode">${y.no_inventaris}</div>
                  <div class="nama">${((H=y.barang)==null?void 0:H.nama_barang)||""}</div>
               </div>
            </div>
            <div class="footer">
              <span>${y.tgl_pengadaan||"-"}</span>
              <span>${((S=y.ruang)==null?void 0:S.nama_ruang)||"Gudang"}</span>
            </div>
          </div>
          <script>
            window.onload = () => { window.print(); window.close(); }
          <\/script>
        </body>
      </html>
    `),$.document.close()},C=y=>y?new Date(y).toLocaleDateString("id-ID"):"-",A=y=>y?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(y):"Rp 0",U=y=>{switch(y){case"Ada":return"bg-green-100 text-green-700";case"Rusak":return"bg-red-100 text-red-700";case"Hilang":return"bg-gray-100 text-gray-700";case"Dipinjam":return"bg-orange-100 text-orange-700";default:return"bg-slate-100 text-slate-700"}};return bt(()=>I()),(y,g)=>{var $,H;return N(),M("div",Tn,[t("div",An,[t("div",Dn,[j(t("input",{"onUpdate:modelValue":g[0]||(g[0]=S=>s.value=S),onInput:I,type:"text",placeholder:"Cari Item Inventaris (No Inventaris / Nama)...",class:"form-input"},null,544),[[R,s.value]])]),t("button",{onClick:D,class:"btn-add"},[...g[10]||(g[10]=[t("i",{class:"fas fa-plus"},null,-1),L(" Tambah Item ",-1)])])]),e.value.length>0?(N(),M("div",jn,[t("div",Rn,[t("div",Un,[g[11]||(g[11]=t("span",{class:"label"},"Total Nilai Aset:",-1)),t("span",Vn,x(A(v.value)),1)])])])):K("",!0),t("div",$n,[t("table",Ln,[g[17]||(g[17]=t("thead",null,[t("tr",null,[t("th",null,"No Inventaris"),t("th",null,"Nama Barang"),t("th",null,"Ruang & Box"),t("th",null,"Asal & Tgl"),t("th",null,"Harga"),t("th",null,"Status"),t("th",{width:"100"},"Aksi")])],-1)),t("tbody",null,[i.value?(N(),M("tr",Hn,[...g[12]||(g[12]=[t("td",{colspan:"7",class:"text-center"},"Memuat...",-1)])])):e.value.length===0?(N(),M("tr",Fn,[...g[13]||(g[13]=[t("td",{colspan:"7",class:"text-center"},"Data kosong",-1)])])):(N(!0),M(W,{key:2},Z(e.value,S=>{var Y,dt;return N(),M("tr",{key:S.no_inventaris},[t("td",Kn,x(S.no_inventaris),1),t("td",zn,x(((Y=S.barang)==null?void 0:Y.nama_barang)||"(Barang Hapus)"),1),t("td",null,[t("div",On,x(((dt=S.ruang)==null?void 0:dt.nama_ruang)||"-"),1),t("div",Jn,"Rak: "+x(S.no_rak)+" | Box: "+x(S.no_box),1)]),t("td",null,[t("div",Gn,x(S.asal_barang),1),t("div",Yn,x(C(S.tgl_pengadaan)),1)]),t("td",qn,x(A(S.harga)),1),t("td",null,[t("span",{class:ft(["status-badge",U(S.status_barang)])},x(S.status_barang),3)]),t("td",null,[t("div",Qn,[t("button",{onClick:Rt=>m(S),class:"btn-icon text-dark",title:"Cetak Stiker"},[...g[14]||(g[14]=[t("i",{class:"fas fa-print"},null,-1)])],8,Wn),t("button",{onClick:Rt=>E(S),class:"btn-icon text-blue"},[...g[15]||(g[15]=[t("i",{class:"fas fa-pen"},null,-1)])],8,Zn),t("button",{onClick:Rt=>c(S.no_inventaris),class:"btn-icon text-red"},[...g[16]||(g[16]=[t("i",{class:"fas fa-trash"},null,-1)])],8,Xn)])])])}),128))])])]),r.value?(N(),M("div",{key:1,class:"modal-overlay",onClick:G(w,["self"])},[t("div",ta,[t("div",ea,[t("h3",null,x(d.value?"Edit":"Tambah")+" Item Inventaris",1),t("button",{onClick:w,class:"close-btn"},"×")]),t("form",{onSubmit:G(u,["prevent"])},[t("div",na,[t("div",aa,[g[18]||(g[18]=t("label",null,"No Inventaris",-1)),j(t("input",{"onUpdate:modelValue":g[1]||(g[1]=S=>f.no_inventaris=S),type:"text",class:"form-input",placeholder:"Otomatis jika kosong",disabled:d.value},null,8,oa),[[R,f.no_inventaris]]),d.value?K("",!0):(N(),M("small",sa,"Biarkan kosong untuk generate otomatis (INV...)"))]),t("div",ia,[g[19]||(g[19]=t("label",null,[L("Barang "),t("span",{class:"text-red"},"*")],-1)),O(J,{modelValue:f.kode_barang,"onUpdate:modelValue":g[2]||(g[2]=S=>f.kode_barang=S),options:P.value,"label-key":"nama_barang","value-key":"kode_barang",placeholder:"Pilih Barang",disabled:d.value},null,8,["modelValue","options","disabled"]),d.value?(N(),M("small",la,"Barang tidak bisa diubah saat edit")):K("",!0)]),t("div",ra,[t("div",da,[g[20]||(g[20]=t("label",null,[L("Ruang "),t("span",{class:"text-red"},"*")],-1)),O(J,{modelValue:f.id_ruang,"onUpdate:modelValue":g[3]||(g[3]=S=>f.id_ruang=S),options:k.value,"label-key":"nama_ruang","value-key":"id_ruang",placeholder:"Pilih Ruang"},null,8,["modelValue","options"])]),t("div",ua,[g[22]||(g[22]=t("label",null,[L("Status "),t("span",{class:"text-red"},"*")],-1)),j(t("select",{"onUpdate:modelValue":g[4]||(g[4]=S=>f.status_barang=S),class:"form-select",required:""},[...g[21]||(g[21]=[t("option",{value:"Ada"},"Ada",-1),t("option",{value:"Dipinjam"},"Dipinjam",-1),t("option",{value:"Rusak"},"Rusak",-1),t("option",{value:"Hilang"},"Hilang",-1)])],512),[[Ut,f.status_barang]])])]),t("div",ca,[t("div",ga,[g[23]||(g[23]=t("label",null,"No Rak",-1)),j(t("input",{"onUpdate:modelValue":g[5]||(g[5]=S=>f.no_rak=S),type:"text",class:"form-input"},null,512),[[R,f.no_rak]])]),t("div",fa,[g[24]||(g[24]=t("label",null,"No Box",-1)),j(t("input",{"onUpdate:modelValue":g[6]||(g[6]=S=>f.no_box=S),type:"text",class:"form-input"},null,512),[[R,f.no_box]])])]),t("div",ma,[t("div",ha,[g[26]||(g[26]=t("label",null,"Harga Perolehan",-1)),t("div",pa,[g[25]||(g[25]=t("span",{class:"prefix"},"Rp",-1)),j(t("input",{"onUpdate:modelValue":g[7]||(g[7]=S=>f.harga=S),type:"number",class:"form-input",min:"0"},null,512),[[R,f.harga]])])]),t("div",ba,[g[27]||(g[27]=t("label",null,"Tgl Pengadaan",-1)),j(t("input",{"onUpdate:modelValue":g[8]||(g[8]=S=>f.tgl_pengadaan=S),type:"date",class:"form-input"},null,512),[[R,f.tgl_pengadaan]])])]),t("div",_a,[g[29]||(g[29]=t("label",null,"Asal Barang",-1)),j(t("select",{"onUpdate:modelValue":g[9]||(g[9]=S=>f.asal_barang=S),class:"form-select"},[...g[28]||(g[28]=[t("option",{value:"Beli"},"Beli",-1),t("option",{value:"Hibah"},"Hibah",-1),t("option",{value:"Produksi Sendiri"},"Produksi Sendiri",-1)])],512),[[Ut,f.asal_barang]])])]),t("div",va,[t("button",{type:"button",onClick:w,class:"btn-cancel"},"Batal"),t("button",{type:"submit",class:"btn-save",disabled:_.value},x(_.value?"Menyimpan...":"Simpan"),9,ya)])],32)])])):K("",!0),a.value?(N(),M("div",{key:2,class:"modal-overlay",onClick:G(p,["self"])},[t("div",ka,[t("div",{class:"modal-header"},[g[30]||(g[30]=t("h3",null,"Cetak Stiker Aset",-1)),t("button",{onClick:p,class:"close-btn"},"×")]),t("div",wa,[t("div",Ca,[g[32]||(g[32]=t("div",{class:"s-header"},"RSIA Aisyiyah Pekajangan",-1)),t("div",Ia,[t("div",Ba,[l.value?(N(),M("img",{key:0,src:l.value,class:"qr-code"},null,8,Ea)):K("",!0)]),t("div",Sa,[g[31]||(g[31]=t("div",{class:"s-label"},"No. Inventaris",-1)),t("div",xa,x(o.value.no_inventaris),1),t("div",Pa,x(($=o.value.barang)==null?void 0:$.nama_barang),1)])]),t("div",Na,[t("span",null,x(C(o.value.tgl_pengadaan)),1),t("span",null,x((H=o.value.ruang)==null?void 0:H.nama_ruang),1)])]),g[33]||(g[33]=t("p",{class:"mt-2 text-muted text-center"},"Preview Stiker (65mm x 40mm)",-1))]),t("div",{class:"modal-footer"},[t("button",{onClick:p,class:"btn-cancel"},"Tutup"),t("button",{onClick:b,class:"btn-save"},[...g[34]||(g[34]=[t("i",{class:"fas fa-print"},null,-1),L(" Cetak Sekarang",-1)])])])])])):K("",!0)])}}},Ta=it(Ma,[["__scopeId","data-v-947ff765"]]),Aa={class:"tab-container"},Da={class:"header-action"},ja={class:"search-box"},Ra={class:"table-responsive"},Ua={class:"data-table"},Va={key:0},$a={key:1},La={class:"font-bold"},Ha={class:"text-xs text-slate-500"},Fa={class:"font-medium"},Ka={class:"text-xs text-slate-500 font-mono"},za=["onClick"],Oa={class:"modal-content"},Ja={class:"modal-body"},Ga={class:"form-group"},Ya={class:"form-group"},qa={class:"form-group"},Qa={class:"form-group"},Wa={class:"form-group"},Za={class:"form-group"},Xa={class:"modal-footer"},to=["disabled"],eo={__name:"SirkulasiTab",setup(n){const e=T([]),i=T(!1),s=T(""),a=T(!1),o=T(!1),l=pt({peminjam:"",tlp:"",no_inventaris:"",tgl_pinjam:"",tgl_kembali:"",nip:"",status_pinjam:"Masih Dipinjam"}),r=T([]),d=T([]),_=gt(()=>r.value.map(h=>{var u,c;return{...h,label:`${h.no_inventaris} - ${((u=h.barang)==null?void 0:u.nama_barang)||""} (${((c=h.ruang)==null?void 0:c.nama_ruang)||""})`}})),f=gt(()=>d.value.map(h=>({...h,label:`${h.nip} - ${h.nama}`}))),P=async()=>{i.value=!0;try{const h=await V.getPeminjaman({search:s.value,limit:100});h.data.data&&(e.value=h.data.data.data)}catch(h){console.error(h)}finally{i.value=!1}},k=async()=>{try{const[h,u]=await Promise.all([V.getInventaris({limit:1e3}),se.getPegawai(1,1e3)]);if(h.data.data){const c=h.data.data.data||h.data.data||[];r.value=c.filter(m=>m.status_barang==="Ada")}u.data.data&&(d.value=u.data.data||[])}catch(h){console.error("Gagal fetch options",h)}},v=()=>{B(),k(),a.value=!0},I=()=>{a.value=!1},B=()=>{Object.assign(l,{peminjam:"",tlp:"",no_inventaris:"",tgl_pinjam:new Date().toISOString().split("T")[0],tgl_kembali:"",nip:"",status_pinjam:"Masih Dipinjam"})},D=async()=>{var h,u;o.value=!0;try{await V.createPeminjaman(l),I(),P()}catch(c){alert("Gagal simpan: "+(((u=(h=c.response)==null?void 0:h.data)==null?void 0:u.message)||c.message))}finally{o.value=!1}},w=async h=>{var u,c;if(confirm("Proses pengembalian barang ini?"))try{const m={peminjam:h.peminjam,no_inventaris:h.no_inventaris,tgl_pinjam:h.tgl_pinjam,nip:h.nip,tlp:h.tlp||"",status_pinjam:"Sudah Kembali",tgl_kembali:new Date().toISOString().split("T")[0]};await V.updatePeminjaman(m),P()}catch(m){alert("Gagal update: "+(((c=(u=m.response)==null?void 0:u.data)==null?void 0:c.message)||m.message))}},E=h=>h?new Date(h).toLocaleDateString("id-ID"):"-";return bt(()=>P()),(h,u)=>(N(),M("div",Aa,[t("div",Da,[t("div",ja,[j(t("input",{"onUpdate:modelValue":u[0]||(u[0]=c=>s.value=c),onInput:P,type:"text",placeholder:"Cari Peminjam / Barang...",class:"form-input"},null,544),[[R,s.value]])]),t("button",{onClick:v,class:"btn-add"},[...u[7]||(u[7]=[t("i",{class:"fas fa-plus"},null,-1),L(" Pinjam Barang ",-1)])])]),t("div",Ra,[t("table",Ua,[u[10]||(u[10]=t("thead",null,[t("tr",null,[t("th",null,"Peminjam"),t("th",null,"Item Inventaris"),t("th",null,"Tgl Pinjam"),t("th",null,"Tgl Kembali"),t("th",null,"Status"),t("th",{width:"100"},"Aksi")])],-1)),t("tbody",null,[i.value?(N(),M("tr",Va,[...u[8]||(u[8]=[t("td",{colspan:"6",class:"text-center"},"Memuat...",-1)])])):e.value.length===0?(N(),M("tr",$a,[...u[9]||(u[9]=[t("td",{colspan:"6",class:"text-center"},"Data kosong",-1)])])):(N(!0),M(W,{key:2},Z(e.value,(c,m)=>{var p,b;return N(),M("tr",{key:m},[t("td",null,[t("div",La,x(c.peminjam),1),t("div",Ha,x(c.nip),1)]),t("td",null,[t("div",Fa,x((b=(p=c.inventaris)==null?void 0:p.barang)==null?void 0:b.nama_barang),1),t("div",Ka,x(c.no_inventaris),1)]),t("td",null,x(E(c.tgl_pinjam)),1),t("td",null,x(c.tgl_kembali?E(c.tgl_kembali):"-"),1),t("td",null,[t("span",{class:ft(["status-badge",c.status_pinjam==="Masih Dipinjam"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"])},x(c.status_pinjam),3)]),t("td",null,[c.status_pinjam==="Masih Dipinjam"?(N(),M("button",{key:0,onClick:C=>w(c),class:"btn-sm bg-blue-500 text-white"}," Kembalikan ",8,za)):K("",!0)])])}),128))])])]),a.value?(N(),M("div",{key:0,class:"modal-overlay",onClick:G(I,["self"])},[t("div",Oa,[t("div",{class:"modal-header"},[u[11]||(u[11]=t("h3",null,"Pinjam Barang",-1)),t("button",{onClick:I,class:"close-btn"},"×")]),t("form",{onSubmit:G(D,["prevent"])},[t("div",Ja,[t("div",Ga,[u[12]||(u[12]=t("label",null,[L("Peminjam "),t("span",{class:"text-red"},"*")],-1)),j(t("input",{"onUpdate:modelValue":u[1]||(u[1]=c=>l.peminjam=c),type:"text",class:"form-input",required:"",placeholder:"Nama Peminjam"},null,512),[[R,l.peminjam]])]),t("div",Ya,[u[13]||(u[13]=t("label",null,"No. Telepon / HP",-1)),j(t("input",{"onUpdate:modelValue":u[2]||(u[2]=c=>l.tlp=c),type:"text",class:"form-input",placeholder:"08..."},null,512),[[R,l.tlp]])]),t("div",qa,[u[14]||(u[14]=t("label",null,[L("Item Inventaris "),t("span",{class:"text-red"},"*")],-1)),O(J,{modelValue:l.no_inventaris,"onUpdate:modelValue":u[3]||(u[3]=c=>l.no_inventaris=c),options:_.value,"label-key":"label","value-key":"no_inventaris",placeholder:"Pilih Item (Cari No / Nama)"},null,8,["modelValue","options"])]),t("div",Qa,[u[15]||(u[15]=t("label",null,[L("Tgl Pinjam "),t("span",{class:"text-red"},"*")],-1)),j(t("input",{"onUpdate:modelValue":u[4]||(u[4]=c=>l.tgl_pinjam=c),type:"date",class:"form-input",required:""},null,512),[[R,l.tgl_pinjam]])]),t("div",Wa,[u[16]||(u[16]=t("label",null,"Rencana Kembali",-1)),j(t("input",{"onUpdate:modelValue":u[5]||(u[5]=c=>l.tgl_kembali=c),type:"date",class:"form-input"},null,512),[[R,l.tgl_kembali]]),u[17]||(u[17]=t("small",{class:"text-hint"},"Isi jika sudah ada rencana tanggal kembali",-1))]),t("div",Za,[u[18]||(u[18]=t("label",null,"Petugas (NIP)",-1)),O(J,{modelValue:l.nip,"onUpdate:modelValue":u[6]||(u[6]=c=>l.nip=c),options:f.value,"label-key":"label","value-key":"nip",placeholder:"Pilih Petugas (Cari Nama / NIK)"},null,8,["modelValue","options"])])]),t("div",Xa,[t("button",{type:"button",onClick:I,class:"btn-cancel"},"Batal"),t("button",{type:"submit",class:"btn-save",disabled:o.value},x(o.value?"Menyimpan...":"Simpan"),9,to)])],32)])])):K("",!0)]))}},no=it(eo,[["__scopeId","data-v-db224360"]]),ao={class:"tab-container"},oo={class:"header-action"},so={class:"search-box"},io={class:"table-responsive"},lo={class:"data-table"},ro={key:0},uo={key:1},co={class:"font-mono"},go={class:"font-medium"},fo={class:"text-xs text-slate-500"},mo={class:"font-bold"},ho={class:"action-group"},po=["onClick"],bo=["onClick"],_o={class:"modal-content modal-lg"},vo={class:"modal-body"},yo={class:"form-row border-b pb-4 mb-4"},ko={class:"form-group"},wo={class:"form-group"},Co={class:"form-group"},Io={class:"details-section"},Bo={class:"w-full text-sm border"},Eo={class:"p-2 border"},So={class:"p-2 border"},xo=["onUpdate:modelValue","onInput"],Po={class:"p-2 border"},No=["onUpdate:modelValue","onInput"],Mo={class:"p-2 border text-right font-medium"},To={class:"p-2 border text-center"},Ao=["onClick"],Do={key:0},jo={class:"bg-gray-100 font-bold"},Ro={class:"p-2 text-right border"},Uo={class:"modal-footer"},Vo=["disabled"],$o={__name:"HibahTab",setup(n){const e=T([]),i=T(!1),s=T(""),a=T(!1),o=T(!1),l=pt({no_hibah:"",tgl_hibah:"",kode_pemberi:"",nip:"",kd_rek_aset:"",totalhibah:0,details:[]}),r=T([]),d=async()=>{i.value=!0;try{const p=await V.getHibah({search:s.value,limit:100});p.data.data&&(e.value=p.data.data.data)}catch(p){console.error(p)}finally{i.value=!1}},_=async()=>{try{const p=await V.getBarang({limit:1e3});p.data.data&&(r.value=p.data.data.data)}catch(p){console.error("Gagal fetch barang",p)}},f=()=>{w(),_(),k(),a.value=!0},P=()=>{a.value=!1},k=()=>{l.details.push({kode_barang:"",jumlah:1,h_hibah:0,subtotalhibah:0})},v=()=>k(),I=p=>{l.details.splice(p,1),D()},B=p=>{p.subtotalhibah=(p.jumlah||0)*(p.h_hibah||0),D()},D=()=>{l.totalhibah=l.details.reduce((p,b)=>p+b.subtotalhibah,0)},w=async()=>{const p=new Date,b=p.getFullYear(),C=String(p.getMonth()+1).padStart(2,"0"),A=String(p.getDate()).padStart(2,"0"),y=`HA${`${b}${C}${A}`}`;let g=1;try{const H=await V.getHibah({limit:1,sort_by:"no_hibah",order:"desc",search:y});if(H.data.data){const S=H.data.data.data||H.data.data||[];if(S.length>0){const Y=S[0];if(Y.no_hibah&&Y.no_hibah.startsWith(y)){const dt=Y.no_hibah.substring(y.length);g=parseInt(dt,10)+1}}}}catch(H){console.error("Gagal generate no hibah",H)}const $=`${y}${String(g).padStart(3,"0")}`;Object.assign(l,{no_hibah:$,tgl_hibah:p.toISOString().split("T")[0],kode_pemberi:"",nip:"",kd_rek_aset:"",totalhibah:0,details:[]})},E=async()=>{var p,b;o.value=!0;try{await V.createHibah(l),P(),d()}catch(C){alert("Gagal simpan: "+(((b=(p=C.response)==null?void 0:p.data)==null?void 0:b.message)||C.message))}finally{o.value=!1}},h=p=>{const b=p.detail.map(C=>{var A;return`- ${((A=C.barang)==null?void 0:A.nama_barang)||C.kode_barang} (${C.jumlah} x ${m(C.h_hibah)})`}).join(`
`);alert(`Detail Hibah ${p.no_hibah}:

${b}

Total: ${m(p.totalhibah)}`)},u=async p=>{if(confirm("Hapus data hibah ini?"))try{await V.deleteHibah(p),d()}catch{alert("Gagal hapus")}},c=p=>p?new Date(p).toLocaleDateString("id-ID"):"-",m=p=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(p);return bt(()=>d()),(p,b)=>(N(),M("div",ao,[t("div",oo,[t("div",so,[j(t("input",{"onUpdate:modelValue":b[0]||(b[0]=C=>s.value=C),onInput:d,type:"text",placeholder:"Cari No Hibah...",class:"form-input"},null,544),[[R,s.value]])]),t("button",{onClick:f,class:"btn-add"},[...b[4]||(b[4]=[t("i",{class:"fas fa-plus"},null,-1),L(" Input Hibah ",-1)])])]),t("div",io,[t("table",lo,[b[9]||(b[9]=t("thead",null,[t("tr",null,[t("th",null,"No Hibah"),t("th",null,"Tanggal"),t("th",null,"Pemberi"),t("th",null,"Total Hibah"),t("th",null,"Jml Item"),t("th",{width:"100"},"Aksi")])],-1)),t("tbody",null,[i.value?(N(),M("tr",ro,[...b[5]||(b[5]=[t("td",{colspan:"6",class:"text-center"},"Memuat...",-1)])])):e.value.length===0?(N(),M("tr",uo,[...b[6]||(b[6]=[t("td",{colspan:"6",class:"text-center"},"Data kosong",-1)])])):(N(!0),M(W,{key:2},Z(e.value,C=>{var A;return N(),M("tr",{key:C.no_hibah},[t("td",co,x(C.no_hibah),1),t("td",null,x(c(C.tgl_hibah)),1),t("td",null,[t("div",go,x(C.kode_pemberi||"-"),1),t("div",fo,"NIP: "+x(C.nip),1)]),t("td",mo,x(m(C.totalhibah)),1),t("td",null,x(((A=C.detail)==null?void 0:A.length)||0)+" Item",1),t("td",null,[t("div",ho,[t("button",{onClick:U=>h(C),class:"btn-icon text-blue"},[...b[7]||(b[7]=[t("i",{class:"fas fa-eye"},null,-1)])],8,po),t("button",{onClick:U=>u(C.no_hibah),class:"btn-icon text-red"},[...b[8]||(b[8]=[t("i",{class:"fas fa-trash"},null,-1)])],8,bo)])])])}),128))])])]),a.value?(N(),M("div",{key:0,class:"modal-overlay",onClick:G(P,["self"])},[t("div",_o,[t("div",{class:"modal-header"},[b[10]||(b[10]=t("h3",null,"Input Hibah Barang",-1)),t("button",{onClick:P,class:"close-btn"},"×")]),t("form",{onSubmit:G(E,["prevent"])},[t("div",vo,[t("div",yo,[t("div",ko,[b[11]||(b[11]=t("label",null,[L("No. Hibah "),t("span",{class:"text-red"},"*")],-1)),j(t("input",{"onUpdate:modelValue":b[1]||(b[1]=C=>l.no_hibah=C),type:"text",class:"form-input",placeholder:"Isi No. Hibah / Dokumen",required:""},null,512),[[R,l.no_hibah]])]),t("div",wo,[b[12]||(b[12]=t("label",null,"Tanggal Hibah",-1)),j(t("input",{"onUpdate:modelValue":b[2]||(b[2]=C=>l.tgl_hibah=C),type:"date",class:"form-input",required:""},null,512),[[R,l.tgl_hibah]])]),t("div",Co,[b[13]||(b[13]=t("label",null,"Pemberi Hibah",-1)),j(t("input",{"onUpdate:modelValue":b[3]||(b[3]=C=>l.kode_pemberi=C),type:"text",class:"form-input",placeholder:"Nama Pemberi / Donatur"},null,512),[[R,l.kode_pemberi]])])]),t("div",Io,[t("div",{class:"flex justify-between items-center mb-2"},[b[15]||(b[15]=t("label",{class:"font-bold"},"Item Hibah",-1)),t("button",{type:"button",onClick:v,class:"btn-sm bg-blue-500 text-white"},[...b[14]||(b[14]=[t("i",{class:"fas fa-plus"},null,-1),L(" Tambah Item ",-1)])])]),t("table",Bo,[b[20]||(b[20]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"p-2 border"},"Barang"),t("th",{class:"p-2 border w-20"},"Jumlah"),t("th",{class:"p-2 border w-32"},"Harga Satuan"),t("th",{class:"p-2 border w-32"},"Subtotal"),t("th",{class:"p-2 border w-10"})])],-1)),t("tbody",null,[(N(!0),M(W,null,Z(l.details,(C,A)=>(N(),M("tr",{key:A},[t("td",Eo,[O(J,{modelValue:C.kode_barang,"onUpdate:modelValue":U=>C.kode_barang=U,options:r.value,"label-key":"nama_barang","value-key":"kode_barang",placeholder:"Pilih Barang"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("td",So,[j(t("input",{"onUpdate:modelValue":U=>C.jumlah=U,type:"number",min:"1",class:"form-input text-sm text-center",onInput:U=>B(C)},null,40,xo),[[R,C.jumlah,void 0,{number:!0}]])]),t("td",Po,[j(t("input",{"onUpdate:modelValue":U=>C.h_hibah=U,type:"number",min:"0",class:"form-input text-sm text-right",onInput:U=>B(C)},null,40,No),[[R,C.h_hibah,void 0,{number:!0}]])]),t("td",Mo,x(m(C.subtotalhibah)),1),t("td",To,[t("button",{type:"button",onClick:U=>I(A),class:"text-red-500 hover:text-red-700"},[...b[16]||(b[16]=[t("i",{class:"fas fa-times"},null,-1)])],8,Ao)])]))),128)),l.details.length===0?(N(),M("tr",Do,[...b[17]||(b[17]=[t("td",{colspan:"5",class:"p-4 text-center text-gray-500"},"Belum ada item ditambahkan",-1)])])):K("",!0)]),t("tfoot",jo,[t("tr",null,[b[18]||(b[18]=t("td",{colspan:"3",class:"p-2 text-right border"},"Total Nilai Hibah:",-1)),t("td",Ro,x(m(l.totalhibah)),1),b[19]||(b[19]=t("td",null,null,-1))])])])])]),t("div",Uo,[t("button",{type:"button",onClick:P,class:"btn-cancel"},"Batal"),t("button",{type:"submit",class:"btn-save",disabled:o.value||l.details.length===0},x(o.value?"Menyimpan...":"Simpan Transaksi"),9,Vo)])],32)])])):K("",!0)]))}},Lo=it($o,[["__scopeId","data-v-ba493d4e"]]),Ho={class:"inventaris-page"},Fo={class:"tabs-nav"},Ko=["onClick"],zo={class:"tab-content"},Oo={__name:"ManajemenInventarisView",setup(n){const e=[{id:"koleksi",label:"Master Barang",icon:"fas fa-boxes",component:Ke},{id:"item",label:"Item Inventaris (Aset)",icon:"fas fa-barcode",component:Ta},{id:"sirkulasi",label:"Sirkulasi / Peminjaman",icon:"fas fa-exchange-alt",component:no},{id:"hibah",label:"Hibah Aset",icon:"fas fa-gift",component:Lo}],i=T(e[0].id),s=gt(()=>{var a;return(a=e.find(o=>o.id===i.value))==null?void 0:a.component});return(a,o)=>(N(),M("div",Ho,[o[0]||(o[0]=t("div",{class:"page-header"},[t("h2",null,"🗄️ Manajemen Inventaris"),t("p",{class:"subtitle"},"Kelola master barang, item inventaris, sirkulasi peminjaman, dan hibah aset.")],-1)),t("div",Fo,[(N(),M(W,null,Z(e,l=>t("button",{key:l.id,class:ft(["tab-btn",{active:i.value===l.id}]),onClick:r=>i.value=l.id},[t("i",{class:ft(l.icon)},null,2),L(" "+x(l.label),1)],10,Ko)),64))]),t("div",zo,[(N(),ae(oe(s.value)))])]))}},Xo=it(Oo,[["__scopeId","data-v-51f7363b"]]);export{Xo as default};
